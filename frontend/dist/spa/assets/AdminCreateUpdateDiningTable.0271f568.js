import{Q as z}from"./QInput.e35961c4.js";import{a as S,Q as E,b as v}from"./QItemLabel.b64ba62a.js";import{Q as M}from"./QSelect.8158f1e7.js";import{Q as U}from"./QCardSection.ef6e6dbe.js";import{Q as D}from"./QCard.5aa3fe54.js";import{d as F,u as P,a as G,c as H,r as N,h as c,bg as $,i as j,k as a,g as s,e as Q,w as t,bG as O,bH as W,aA as X,aB as Y,o as _,bI as T,f,t as n,ag as J,b2 as K,b3 as Z,j as ee,n as B}from"./index.1c3783dc.js";import{Q as ae,o as te}from"./on-form-validation-error.73894483.js";import{u as le,C,B as se}from"./BigSpinner.fa6acb5e.js";import{c as oe}from"./fuzzy-search.950e6fed.js";import{_ as ie}from"./BackButton.862284a1.js";import"./use-dark.af62a438.js";import"./focus-manager.05708ea9.js";import"./QChip.71405c2d.js";import"./QMenu.915cc552.js";import"./position-engine.748a335e.js";import"./QDialog.69ef5705.js";import"./focusout.1641dfbb.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./QTooltip.a983157c.js";const re={class:"max-w-sm q-mx-auto"},ue={class:"row justify-end q-gutter-sm q-mt-md"},Ce=F({__name:"AdminCreateUpdateDiningTable",setup(ne){const r=P(),m=G(),b=H(),g=N(!1),d=N(""),y=c(()=>b.currentRoute.value.params.id),u=c(()=>y.value?m.state.diningTables.tables.find(o=>o.id===y.value):void 0),I=c(()=>[C.EMPLOYEES,C.DINING_TABLES]),h=N(""),l=N(),w=c(()=>oe(m.state.employees.employees,["firstName","lastName","email"])),L=c(()=>w.value.search(h.value).map(o=>({...o,label:o.lastName+" "+o.firstName})));let A=le(I,{store:m});const q=$(()=>{u.value?(d.value=u.value.number,l.value={...u.value.employee,label:u.value.employee.lastName+" "+u.value.employee.firstName},q()):y.value&&m.state.diningTables.tables.length&&b.push("/404")},{flush:"post"}),x=(o,i)=>{i(()=>{h.value=o})},R=async()=>{var o,i,e,p,V,k;g.value=!0,m.commit.sync(u.value?O({table:{id:u.value.id,number:d.value,employee:{id:(o=l.value)==null?void 0:o.id,firstName:(i=l.value)==null?void 0:i.firstName,lastName:(e=l.value)==null?void 0:e.lastName}}}):W({table:{number:d.value,employee:{id:(p=l.value)==null?void 0:p.id,firstName:(V=l.value)==null?void 0:V.firstName,lastName:(k=l.value)==null?void 0:k.lastName}}})).then(()=>{X.create({type:"positive",position:"top",timeout:Y,message:u.value?r.value.updateSuccess:r.value.createSuccess,multiLine:!0,group:!1}),b.push("/admin/dining-tables")}).finally(()=>{g.value=!1})};return(o,i)=>(_(),j("div",re,[a(ie),s(A)?(_(),Q(se,{key:0})):(_(),Q(ae,{key:1,onSubmit:R,onValidationError:s(te)},{default:t(()=>[a(D,{class:"q-pa-md"},{default:t(()=>[a(U,{class:"q-gutter-lg"},{default:t(()=>[a(z,{modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=e=>d.value=e),modelModifiers:{trim:!0},"stack-label":"",label:`${s(r).tableNumberLabel} *`,"lazy-rules":"",type:"text",rules:[e=>!!e&&e.length>0||s(r).fieldRequired,e=>e.length<=s(T)||s(r).maxLength({max:s(T)})]},null,8,["modelValue","label","rules"]),a(M,{modelValue:l.value,"onUpdate:modelValue":i[1]||(i[1]=e=>l.value=e),"use-input":"","fill-input":"","stack-label":"",clearable:"","hide-selected":"","input-debounce":"0",options:L.value,onFilter:x,label:`${s(r).waiter} *`,rules:[e=>!!e||s(r).fieldRequired]},{selected:t(()=>[l.value?(_(),Q(S,{key:0},{default:t(()=>[a(E,null,{default:t(()=>[a(v,null,{default:t(()=>{var e,p;return[f(n((e=l.value)==null?void 0:e.lastName)+" "+n((p=l.value)==null?void 0:p.firstName),1)]}),_:1}),a(v,{caption:""},{default:t(()=>{var e;return[f(n((e=l.value)==null?void 0:e.email),1)]}),_:1})]),_:1})]),_:1})):J("",!0)]),option:t(e=>[a(S,K(Z(e.itemProps)),{default:t(()=>[a(E,null,{default:t(()=>[a(v,null,{default:t(()=>[f(n(e.opt.lastName)+" "+n(e.opt.firstName),1)]),_:2},1024),a(v,{caption:""},{default:t(()=>[f(n(e.opt.email),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":t(()=>[a(S,null,{default:t(()=>[a(E,null,{default:t(()=>[f(n(s(r).noResults),1)]),_:1})]),_:1})]),_:1},8,["modelValue","options","label","rules"])]),_:1})]),_:1}),ee("div",ue,[a(B,{label:s(r).cancel,onClick:i[2]||(i[2]=()=>s(b).back()),color:"dark",flat:""},null,8,["label"]),a(B,{label:s(r).save,loading:g.value,type:"submit",color:"primary"},null,8,["label","loading"])])]),_:1},8,["onValidationError"]))]))}});export{Ce as default};
