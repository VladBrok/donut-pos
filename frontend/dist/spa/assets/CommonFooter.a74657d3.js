import{d as x,o as d,e as g,p as M,G as X,X as I,aw as j,h as v,Z,q as p,Q as z,s as P,x as J,v as W,u as $,w as s,ax as S,i as D,ah as G,g as o,ai as B,k as l,a5 as R,f as k,t as f,ag as T,r as ee,a as K,ay as O,j as r,n as C,aj as te,az as oe}from"./index.3f3b8c57.js";import{Q as E}from"./QInput.af205288.js";import{Q}from"./QTooltip.64d8fdeb.js";import{Q as ae}from"./NoData.f3f3f67f.js";import{g as le,a as ne,b as se}from"./get-order-total-cost.0ab55512.js";import{g as ie,_ as re}from"./get-order-type-icon.c0a167f8.js";import{u as ce,a as ue}from"./use-dark.fca62a05.js";import{s as de,f as me}from"./date.b6f3ce26.js";import{_ as pe}from"./OrderView.fe1bc0bf.js";import{_ as _e}from"./PaymentMethodsModal.49b92ce9.js";import{a as V,Q as A,b as U}from"./QItemLabel.b85da9a3.js";import{Q as fe}from"./QList.cda24842.js";import{Q as ve}from"./QBtnDropdown.bd396750.js";import{C as F}from"./ClosePopup.880cf5c6.js";import{f as Y,m as H}from"./address.94d37a80.js";import{u as ye,C as ge}from"./BigSpinner.f02a38f1.js";import{Q as he}from"./QImg.bc00f4b6.js";import{f as be}from"./phone.158664be.js";function we(t){return(t==null?void 0:t.dishes.reduce((a,e)=>a+e.count,0))||0}const ke=x({__name:"LogoImage",props:{noText:{type:Boolean}},setup(t){return(a,e)=>(d(),g(he,{src:a.noText?"/logo-no-text.png":"/logo-text.png",alt:"Donut POS logo",fit:"cover"},null,8,["src"]))}});var Se=M({name:"QTimelineEntry",props:{heading:Boolean,tag:{type:String,default:"h3"},side:{type:String,default:"right",validator:t=>["left","right"].includes(t)},icon:String,avatar:String,color:String,title:String,subtitle:String,body:String},setup(t,{slots:a}){const e=X(j,I);if(e===I)return console.error("QTimelineEntry needs to be child of QTimeline"),I;const _=v(()=>`q-timeline__entry q-timeline__entry--${t.side}`+(t.icon!==void 0||t.avatar!==void 0?" q-timeline__entry--icon":"")),n=v(()=>`q-timeline__dot text-${t.color||e.color}`),c=v(()=>e.layout==="comfortable"&&e.side==="left");return()=>{const u=Z(a.default,[]);if(t.body!==void 0&&u.unshift(t.body),t.heading===!0){const h=[p("div"),p("div"),p(t.tag,{class:"q-timeline__heading-title"},u)];return p("div",{class:"q-timeline__heading"},c.value===!0?h.reverse():h)}let y;t.icon!==void 0?y=[p(z,{class:"row items-center justify-center",name:t.icon})]:t.avatar!==void 0&&(y=[p("img",{class:"q-timeline__dot-img",src:t.avatar})]);const i=[p("div",{class:"q-timeline__subtitle"},[p("span",{},P(a.subtitle,[t.subtitle]))]),p("div",{class:n.value},y),p("div",{class:"q-timeline__content"},[p("h6",{class:"q-timeline__title"},P(a.title,[t.title]))].concat(u))];return p("li",{class:_.value},c.value===!0?i.reverse():i)}}}),De=M({name:"QTimeline",props:{...ce,color:{type:String,default:"primary"},side:{type:String,default:"right",validator:t=>["left","right"].includes(t)},layout:{type:String,default:"dense",validator:t=>["dense","comfortable","loose"].includes(t)}},setup(t,{slots:a}){const e=W(),_=ue(t,e.proxy.$q);J(j,t);const n=v(()=>`q-timeline q-timeline--${t.layout} q-timeline--${t.layout}--${t.side}`+(_.value===!0?" q-timeline--dark":""));return()=>p("ul",{class:n.value},P(a.default))}});const qe=x({__name:"OrderHistory",props:{order:{}},setup(t){const a=t,e=v(()=>{const n=a.order,u=[[n.createdDate,S.CREATED],[n.cookingDate,S.COOKING],[n.cookedDate,S.COOKED],[n.deliveringDate,S.DELIVERING],[n.deliveredDate,S.DELIVERED],[n.paidDate,S.PAID]].filter(i=>Boolean(i[0]));return de(u,i=>i[0]).map(i=>({date:i[0],name:i[1]}))}),_=$();return(n,c)=>(d(),g(De,{class:"w-fit"},{default:s(()=>[(d(!0),D(B,null,G(e.value,(u,y)=>(d(),g(Se,{key:y,title:o(_)[`orderStatus_${u.name}`],subtitle:o(me)(u.date),color:u.name},null,8,["title","subtitle","color"]))),128))]),_:1}))}}),Te=x({__name:"PrintButton",props:{allowPrintTicket:{type:Boolean}},setup(t){const a=$();function e(){console.log("print ticket")}function _(){console.log("print receipt")}return(n,c)=>(d(),g(ve,{color:"primary",label:o(a).print,icon:"print",outline:""},{default:s(()=>[l(fe,null,{default:s(()=>[n.allowPrintTicket?R((d(),g(V,{key:0,clickable:"",onClick:e},{default:s(()=>[l(A,null,{default:s(()=>[l(U,null,{default:s(()=>[k(f(o(a).printTicket),1)]),_:1})]),_:1})]),_:1})),[[F]]):T("",!0),R((d(),g(V,{clickable:"",onClick:_},{default:s(()=>[l(A,null,{default:s(()=>[l(U,null,{default:s(()=>[k(f(o(a).printReceipt),1)]),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),_:1},8,["label"]))}}),Ce={class:"flex-basis-50"},xe={key:0,class:"row justify-center"},at=x({__name:"OrderDetailsView",props:{order:{},fullScreen:{type:Boolean}},setup(t){const a=t,e=v(()=>a.order),_=v(()=>le(e.value)),n=v(()=>ne(e.value)),c=$(),u=ee(!1),y=K(),i=v(()=>{var m;return(m=y.state.auth.user.permissions)==null?void 0:m.client});function h(){var m;(m=window==null?void 0:window.open(`http://www.google.com/maps/place?q=${H(e.value.address)}`,"_blank"))==null||m.focus()}return(m,w)=>(d(),D(B,null,[l(pe,{"has-content":Boolean(e.value),"dish-count":o(we)(e.value),"total-cost":_.value,"delivery-cost":o(oe),"dish-cost":n.value,"full-content-height":m.fullScreen,"card-padding":m.fullScreen,"apply-shadow":m.fullScreen,"order-type":e.value.type},{content:s(()=>{var b,L;return[i.value?T("",!0):(d(),g(Te,{key:0,class:"q-mb-md","allow-print-ticket":e.value.type===o(O).TAKEOUT},null,8,["allow-print-ticket"])),r("div",null,[r("div",null,[l(E,{"stack-label":"",readonly:"","model-value":(b=o(c)[`orderType_${e.value.type}`])==null?void 0:b.toString(),type:"text",label:o(c).orderTypeLabel,class:"q-mb-md"},{before:s(()=>[l(z,{name:o(ie)(e.value.type)},null,8,["name"])]),_:1},8,["model-value","label"]),e.value.type===o(O).DELIVERY?(d(),g(E,{key:0,"model-value":o(Y)(e.value.address),readonly:"","stack-label":"",label:`${o(c).deliveryAddress}`,type:"text",class:"q-mb-md w-fit"},{after:s(()=>[l(C,{round:"",dense:"",icon:"location_on",color:"primary",onClick:h},{default:s(()=>[l(Q,null,{default:s(()=>[k(f(o(c).showOnMap),1)]),_:1})]),_:1})]),_:1},8,["model-value","label"])):T("",!0),e.value.type===o(O).DINE_IN?(d(),g(E,{key:1,"model-value":((L=e.value.table)==null?void 0:L.number)||"-",readonly:"","stack-label":"",label:`${o(c).tableNumberLabel}`,type:"text",class:"q-mb-md"},null,8,["model-value","label"])):T("",!0),l(E,{"model-value":e.value.comment||"-","stack-label":"",label:`${o(c).commentLabel}`,type:"textarea",readonly:"",rows:"1",autogrow:"",class:"q-mb-md"},null,8,["model-value","label"])]),r("div",{class:te(["no-wrap",{"order-details-flex":m.fullScreen}])},[r("div",Ce,[(d(!0),D(B,null,G(e.value.dishes,q=>(d(),D("div",{key:q.dishIdInOrder},[l(re,{dish:q,count:q.count,"total-cost":o(se)(q),modifications:q.modifications.map(N=>({count:N.count,modification:N})),"view-only":""},null,8,["dish","count","total-cost","modifications"]),l(ae)]))),128))]),l(qe,{class:"q-mt-xl",order:e.value},null,8,["order"])],2)])]}),options:s(()=>[e.value.paidDate?T("",!0):(d(),D("div",xe,[l(C,{color:"primary",type:"submit",onClick:w[0]||(w[0]=b=>u.value=!0),class:"q-px-lg q-py-xs",size:"md"},{default:s(()=>[k(f(o(c).pay),1)]),_:1})]))]),_:1},8,["has-content","dish-count","total-cost","delivery-cost","dish-cost","full-content-height","card-padding","apply-shadow","order-type"]),l(_e,{modelValue:u.value,"onUpdate:modelValue":w[1]||(w[1]=b=>u.value=b),"total-cost":_.value,"order-number":e.value.orderNumber,"order-id":e.value.id,"order-type":e.value.type},null,8,["modelValue","total-cost","order-number","order-id","order-type"])],64))}}),Ee={class:"bg-white shadow-up-1 q-px-md q-py-md"},Qe={class:"row gap-md"},$e={class:"row items-center q-pl-sm",style:{flex:"0 0 25%"}},Ie={style:{flex:"0 0 35%"},class:"row items-center"},Oe={class:"row no-wrap items-center gap-xs q-mb-sm"},Pe={class:"row no-wrap items-center gap-xs q-mb-sm"},Be={class:"row no-wrap items-center gap-xs"},Le={style:{flex:"1 0 35%"},class:"row items-center"},Ne={class:"text-weight-bold"},Re={class:"text-dark-lighter"},lt=x({__name:"CommonFooter",setup(t){const a=$(),e=K();v(()=>e.state.auth.user.userId);const _=v(()=>[ge.DEFAULT_SALE_POINT]);ye(_,{store:e});const n=v(()=>e.state.salePoints.defaultSalePoint);function c(){var i,h;(h=window==null?void 0:window.open(`http://www.google.com/maps/place?q=${H((i=n.value)==null?void 0:i.address)}`,"_blank"))==null||h.focus()}function u(){var i;window==null||window.open(`tel:${(i=n.value)==null?void 0:i.phone}`)}function y(){var i;window==null||window.open(`mailto:${(i=n.value)==null?void 0:i.email}`)}return(i,h)=>{var m,w,b;return d(),D("footer",Ee,[r("div",Qe,[r("div",$e,[l(ke,{style:{width:"130px"}})]),r("div",Ie,[r("div",null,[r("div",Oe,[l(C,{round:"",dense:"",outline:"",icon:"location_on",color:"primary",size:"md",onClick:c},{default:s(()=>[l(Q,null,{default:s(()=>[k(f(o(a).showOnMap),1)]),_:1})]),_:1}),r("div",null,f(o(Y)((m=n.value)==null?void 0:m.address)),1)]),r("div",Pe,[l(C,{outline:"",round:"",dense:"",icon:"call",color:"primary",onClick:u},{default:s(()=>[l(Q,null,{default:s(()=>[k(f(o(a).callUs),1)]),_:1})]),_:1}),r("div",null,f(o(be)(((w=n.value)==null?void 0:w.phone)||"")),1)]),r("div",Be,[l(C,{outline:"",round:"",dense:"",icon:"mail",color:"primary",onClick:y},{default:s(()=>[l(Q,null,{default:s(()=>[k(f(o(a).writeUsEmail),1)]),_:1})]),_:1}),r("div",null,f((b=n.value)==null?void 0:b.email),1)])])]),r("div",Le,[r("div",null,[r("p",Ne,f(o(a).donutPosFooterTitle),1),r("p",Re,f(o(a).donutPosFooterDescription),1)])])])])}}});export{ke as _,at as a,lt as b,we as g};
