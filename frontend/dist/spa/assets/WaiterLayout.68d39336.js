import{d as y,i as C,t as u,g as e,o as c,u as S,a as N,r as O,j as l,k as a,w as i,n as E,bS as V,f as I,h as _,e as b,bT as T,A as B,a9 as L,ai as q,aj as $,bU as D,b7 as M,bV as j}from"./index.e78f07d2.js";import{u as Y,C as w}from"./BigSpinner.12aaa730.js";import{a as F}from"./date.b6f3ce26.js";import{_ as A}from"./OrderNumberTitle.e800051e.js";import{a as H}from"./PaymentMethodsModal.a327a2c2.js";import{f as K}from"./currency.2af12bed.js";import{C as Q}from"./CommonTooltip.0edc01ee.js";import{_ as W,a as z,b as G,c as J}from"./NotificationsBell.336c8e3c.js";import{_ as X}from"./get-order-type-icon.25344ebe.js";import{_ as Z,a as ee}from"./MainLayout.83bf443a.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./dayjs.min.78c0669c.js";import"./focusout.5149158e.js";import"./QSpace.05e62aaf.js";import"./QCardSection.474d709b.js";import"./QCard.679619c2.js";import"./use-dark.a8697592.js";import"./QDialog.2d6aecbf.js";import"./position-engine.87ce25ed.js";import"./focus-manager.05708ea9.js";import"./portal.20c95002.js";import"./ClosePopup.d130a45b.js";import"./ClickableCardItem.24ce8c9f.js";import"./QImg.18303433.js";import"./QItemLabel.ded98037.js";import"./QList.5cbf1bc0.js";import"./browser.1a1bd576.js";import"./QInput.5e01f4a0.js";import"./on-form-validation-error.d7847268.js";import"./get-order-total-cost.c30b6c87.js";import"./address.b5e3391c.js";import"./capitalize.b0e9fa3f.js";import"./CommonFooter.d4a93731.js";import"./NoData.bf12ea80.js";import"./OrderView.765dd0bc.js";import"./QBtnDropdown.7617be62.js";import"./QMenu.e3114e00.js";import"./LogoImage.0b14271f.js";import"./phone.158664be.js";import"./QSelect.5cca8257.js";import"./QChip.b06db36b.js";import"./AddAddressModal.3d09dd8e.js";import"./PhoneInput.c9981377.js";import"./create-order.e1f65d8a.js";import"./fuzzy-search.950e6fed.js";import"./ConfirmDialog.b9893c8e.js";import"./ProductCounter.ee271323.js";const te={class:"text-dark-lighter text-caption"},oe=y({__name:"NotificationTime",props:{time:{}},setup(h){return(r,d)=>(c(),C("div",te,u(e(F)(r.time)),1))}}),re={class:"row no-wrap gap-md q-py-md q-px-xs items-center"},se={class:"flex-grow"},ae={class:"text-body2"},ne={class:"q-mb-xs row no-wrap items-center justify-between"},ie={class:"text-subtitle1 text-weight-bold"},le={class:"q-mt-md row gap-sm justify-between"},ue={class:"text-primary text-h5 q-pr-sm"},de=y({__name:"CashPaymentRequest",props:{request:{}},setup(h){const r=h,d=S(),t=N(),p=O(!1),s=O(!1),f=()=>{s.value=!0,t.commit.sync(V({id:r.request.id})).finally(()=>{s.value=!1})};return(m,n)=>(c(),C("div",re,[l("div",se,[l("div",ae,[l("div",ne,[l("p",ie,u(e(d).cashPaymentRequest),1),a(oe,{time:m.request.requestedAt},null,8,["time"])]),l("div",null,u(e(d).tableNumber)+" "+u(m.request.table.number||"-")+", ",1),a(A,{"order-number":m.request.orderNumber,"is-link":""},null,8,["order-number"])]),l("div",null,[l("div",le,[a(E,{color:"primary",onClick:n[0]||(n[0]=v=>p.value=!0),loading:s.value},{default:i(()=>[I(u(e(d).acceptPayment),1)]),_:1},8,["loading"]),l("div",ue,u(e(K)(m.request.totalCost)),1)])])]),a(H,{modelValue:p.value,"onUpdate:modelValue":n[1]||(n[1]=v=>p.value=v),onClose:n[2]||(n[2]=v=>p.value=!1),"total-cost":m.request.totalCost,"order-number":m.request.orderNumber,onPaid:f},null,8,["modelValue","total-cost","order-number"])]))}}),me=y({__name:"CookedDishStatusButton",props:{cookedDish:{}},emits:["statusUpdated"],setup(h,{emit:r}){const d=h,t=r,p=S(),s=N(),f=O(!1),m=_(()=>s.state.auth.user.userId);function n(){f.value=!0,s.commit.sync(T({employeeId:m.value||"",orderId:d.cookedDish.order.id,orderNumber:d.cookedDish.order.orderNumber,dishIdInOrder:d.cookedDish.dish.dishIdInOrder})).then(()=>{t("statusUpdated")}).finally(()=>{f.value=!1})}return(v,g)=>(c(),b(e(E),{color:"primary",loading:f.value,onClick:n},{default:i(()=>[I(u(e(p).delivered),1)]),_:1},8,["loading"]))}}),ce={class:"text-body2"},pe={class:"text-h5"},it=y({__name:"WaiterLayout",setup(h){const r=S(),d=_(()=>[{icon:"o_restaurant_menu",label:r.value.menu,to:"/waiter/menu",meta:r.value.menu},{icon:"o_receipt_long",label:r.value.orders,to:"/waiter/orders",meta:r.value.orders}]),t=N(),p=_(()=>t.state.orderDrawer.isCurrentOrderOpen),s=O(t.state.auth.user.userId),f=_(()=>s.value===M.userId?[]:[w.COOKED_DISHES_OF_EMPLOYEE(s.value),w.CASH_PAYMENT_REQUESTS_OF_EMPLOYEE(s.value),w.COOKED_ORDERS(s.value)]);let m=Y(f,{store:t});const n=_(()=>t.state.orders.cookedDishes),v=_(()=>t.state.orders.cookedOrders),g=_(()=>t.state.cashPaymentRequests.requests),U=_(()=>n.value.length+g.value.length+v.value.length),x=O(()=>{});B(()=>{x.value=t.client.on("user",P=>{s.value=P})}),L(()=>{x.value()});function R(){p.value?t.commit.local(D()):t.commit.local(j())}return(P,k)=>(c(),b(Z,{"menu-list":d.value},{actions:i(()=>[a(z,{"is-loading":e(m),"notification-count":U.value},{"notification-list":i(()=>[(c(!0),C($,null,q(g.value,o=>(c(),b(de,{key:o.id,request:o},null,8,["request"]))),128)),(c(!0),C($,null,q(v.value,o=>(c(),b(W,{key:o.order.id,order:o},null,8,["order"]))),128)),(c(!0),C($,null,q(n.value,o=>(c(),b(X,{key:o.dish.dishIdInOrder,dish:o.dish,count:o.dish.count,order:o.order,"view-only":"","hide-price":""},{"additonal-info":i(()=>[l("div",ce,[l("div",null,u(e(r).tableNumber)+" "+u(o.order.table.number||"-")+", ",1),a(A,{"order-number":o.order.orderNumber,"is-link":""},null,8,["order-number"])])]),actions:i(()=>[a(me,{"cooked-dish":o},null,8,["cooked-dish"])]),_:2},1032,["dish","count","order"]))),128))]),_:1},8,["is-loading","notification-count"]),a(E,{class:"q-mr-sm shopping-basket",flat:"",round:"",icon:"o_shopping_basket",onClick:R,title:e(r).openCurrentOrder},{default:i(()=>[a(Q,null,{default:i(()=>[I(u(e(r).openCurrentOrder),1)]),_:1}),a(G)]),_:1},8,["title"])]),drawers:i(()=>[a(ee,{"model-value":p.value,"onUpdate:modelValue":k[0]||(k[0]=o=>e(t).commit.local(e(D)())),onClose:k[1]||(k[1]=o=>e(t).commit.local(e(D)()))},{title:i(()=>[l("p",pe,u(e(r).currentOrder),1)]),content:i(()=>[a(J)]),_:1},8,["model-value"])]),_:1},8,["menu-list"]))}});export{it as default};
