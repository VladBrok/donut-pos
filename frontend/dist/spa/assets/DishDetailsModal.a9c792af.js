import{Q as M}from"./QSpace.9655fa2d.js";import{u as I,d as B,h as H,e as v,w as n,ak as D,o as a,j as m,k as l,i as w,t as g,ah as f,f as k,g as p,m as R,r as T,n as S,c8 as U,bX as x,a as F,H as L,a5 as z,aj as E,ai as V,aZ as G,bO as W}from"./index.a23228fb.js";import{Q as _}from"./QCardSection.444a02ed.js";import{Q as X}from"./NoData.fbf2e14c.js";import{Q as P}from"./QCard.ad74cc7a.js";import{Q as Z}from"./QDialog.7ec1d928.js";import{C as N}from"./ClosePopup.365cb15f.js";import{Q as q}from"./QTooltip.8df9f225.js";import{s as J}from"./sanitize-html.328c4bb3.js";import{Q as K}from"./QImg.52845af8.js";import{f as Y}from"./currency.2af12bed.js";import{_ as ee}from"./ProductCounter.285a5e2c.js";function te(d){const i=I();return`${d} ${i.value.weightGram}`}function ie(d,i){if(i<=0)throw new Error(`Max length ${i} should be > 0`);return d.length<=i?d:d.slice(0,i)+"..."}const oe={class:"column no-wrap full-height"},ne={key:0,class:"absolute-full text-h6 flex flex-center"},se={class:"row justify-between q-px-md"},ae={class:"text-body2 text-dark-gray"},re={key:0,class:"text-primary"},j=B({__name:"ProductCard",props:{price:{},weight:{},name:{},imageUrl:{},noShadow:{type:Boolean},textSize:{},caption:{}},setup(d){const i=d,o=H(()=>({"text-h5":!i.textSize||i.textSize==="lg","text-h6":i.textSize==="sm"}));return(t,u)=>(a(),v(P,{class:D([{"shadow-0":t.noShadow},"full-height"])},{default:n(()=>[m("div",oe,[l(_,null,{default:n(()=>[l(K,{src:t.imageUrl,alt:t.name,fit:"cover",class:"image-card shadow-3 rounded-borders product-card-image"},{default:n(()=>[t.caption?(a(),w("div",ne,g(t.caption),1)):f("",!0)]),_:1},8,["src","alt"])]),_:1}),m("div",se,[m("div",{class:D(["q-mr-sm",o.value])},[m("div",null,[k(g(t.textSize==="sm"?p(ie)(t.name,20):t.name)+" ",1),t.textSize==="sm"?(a(),v(q,{key:0},{default:n(()=>[k(g(t.name),1)]),_:1})):f("",!0)]),m("div",ae,g(p(te)(t.weight)),1)],2),m("div",{class:D(["flex-grow text-right",o.value])},[t.price?(a(),w("span",re,g(p(Y)(t.price)),1)):f("",!0),R(t.$slots,"right")],2)]),R(t.$slots,"default")])]),_:3},8,["class"]))}}),le=m("span",{class:"text-h5 q-pr-sm"},"+",-1),de=m("span",{class:"text-h5"},"+",-1),ce=["innerHTML"],ue={key:0},me=B({__name:"DishCard",props:{dish:{},expanded:{type:Boolean},hidePrice:{type:Boolean},count:{}},emits:["openDetailsClick","addClick"],setup(d,{emit:i}){const o=i,t=T(),u=I();return(e,r)=>(a(),w("div",{ref_key:"containerRef",ref:t},[l(j,{"no-shadow":e.expanded,"image-url":e.dish.imageUrl,price:e.hidePrice?void 0:e.dish.price,weight:e.dish.weight,name:e.dish.name,caption:e.dish.isActive?void 0:p(u).outOfStock},{right:n(()=>[e.count!=null?(a(),w("span",ue," x "+g(e.count),1)):f("",!0)]),default:n(()=>[e.expanded?f("",!0):(a(),v(_,{key:0,class:"q-mt-auto row justify-end"},{default:n(()=>[e.dish.isActive?(a(),v(S,{key:0,color:"primary","icon-right":"shopping_basket",padding:"0 sm",class:"q-mr-md",onClick:r[0]||(r[0]=h=>o("openDetailsClick")),title:p(u).openDetails},{default:n(()=>[le,l(q,null,{default:n(()=>[k(g(p(u).openDetails),1)]),_:1})]),_:1},8,["title"])):f("",!0),e.dish.isActive?(a(),v(S,{key:1,color:"primary",padding:"0 sm",outline:"",onClick:r[1]||(r[1]=h=>o("addClick",t.value)),title:p(u).addToCurrentOrder},{default:n(()=>[de,l(q,null,{default:n(()=>[k(g(p(u).addToCurrentOrder),1)]),_:1})]),_:1},8,["title"])):f("",!0)]),_:1})),e.expanded&&e.dish.description?(a(),v(_,{key:1},{default:n(()=>[m("div",{class:"text-body1",innerHTML:p(J)(e.dish.description)},null,8,ce)]),_:1})):f("",!0)]),_:1},8,["no-shadow","image-url","price","weight","name","caption"])],512))}});function pe({timing:d,draw:i,duration:o}){const t=performance.now();requestAnimationFrame(function u(e){let r=(e-t)/o;r>1&&(r=1);const h=d(r);i(h),r<1&&requestAnimationFrame(u)})}function he(d,i,o){if(o){const t=o.querySelector(".product-card-image"),u=t==null?void 0:t.cloneNode(!0);if(t&&u){const e=u;e.style.position="absolute",document.body.appendChild(e);const r=t.getBoundingClientRect().left+document.documentElement.scrollLeft+10,h=t.getBoundingClientRect().top+document.documentElement.scrollTop-10,$=document.querySelector(".shopping-basket"),O=$.getBoundingClientRect().left+document.documentElement.scrollLeft+10-r,b=$.getBoundingClientRect().top+document.documentElement.scrollTop-10-h,s=t.getBoundingClientRect().width,c=t.getBoundingClientRect().height,C=s/4-s,Q=c/4-c;e.style.left=`${r}px`,e.style.top=`${h}px`,e.style.width=`${t.getBoundingClientRect().width}px`,e.style.height=`${t.getBoundingClientRect().height}px`,e.style.zIndex="9999",pe({duration:x,timing:y=>y,draw:y=>{var A;e.style.left=`${r+O*y}px`,e.style.top=`${h+b*y}px`,e.style.width=`${s+C*y}px`,e.style.height=`${c+Q*y}px`,e.style.opacity=(A=Math.max(1-y,.1))==null?void 0:A.toString(),y>=1&&e.remove()}})}}d.commit.crossTab(U({dish:i}))}const fe=B({__name:"ModificationCard",props:{modification:{},hidePrice:{type:Boolean}},setup(d){return(i,o)=>(a(),v(j,{"image-url":i.modification.imageUrl,price:i.hidePrice?void 0:i.modification.price,name:i.modification.name,weight:i.modification.weight,"text-size":"sm"},{default:n(()=>[l(_,{class:"q-mt-auto row justify-end"},{default:n(()=>[R(i.$slots,"default")]),_:3})]),_:3},8,["image-url","price","name","weight"]))}}),ge={class:"text-weight-bold text-h5"},ve={class:"q-mt-sm row"},Qe=B({__name:"DishDetailsModal",props:{dish:{},viewOnly:{type:Boolean},count:{}},setup(d){const i=d,o=H(()=>i.dish),t=I(),u=F(),e=T(new Map),r=T(),h=T();L(o,()=>{var s;e.value.clear(),(s=o.value)==null||s.modifications.forEach(c=>{e.value.set(c.id,(c==null?void 0:c.count)||0)})},{immediate:!0});function $(s){e.value.set(s,(e.value.get(s)||0)-1)}function O(s){e.value.set(s,(e.value.get(s)||0)+1)}function b(){G(o.value,"Expected to have a dish at this point"),h.value="fade",setTimeout(()=>{h.value=void 0},300);const s={cookedDate:"",cookingDate:"",deliveredDate:"",status:"",count:1,dishIdInOrder:W(),...o.value,modifications:o.value.modifications.filter(c=>e.value.get(c.id)).map(c=>({...c,count:e.value.get(c.id)||-1}))};he(u,s,r.value)}return(s,c)=>(a(),v(Z,{"transition-hide":h.value},{default:n(()=>[l(P,{class:"dialog-md"},{default:n(()=>[l(_,{class:"row items-center q-pb-none"},{default:n(()=>[l(M),z(l(S,{icon:"close",flat:"",round:"",dense:"",title:p(t).close},null,8,["title"]),[[N]])]),_:1}),o.value?(a(),w("div",{key:0,class:"row scroll restricted-height-modal",ref_key:"dishContainerRef",ref:r},[m("div",{class:D(["col-12 col-sm-6",{"q-mx-auto":!o.value.modifications.length}])},[l(me,{dish:o.value,expanded:"","hide-price":s.viewOnly,count:s.count},null,8,["dish","hide-price","count"])],2),o.value.modifications.length?(a(),v(_,{key:0,class:"col-12 col-sm-6"},{default:n(()=>[m("div",ge,g(p(t).modificationsTitle)+": ",1),m("div",ve,[(a(!0),w(E,null,V(o.value.modifications,C=>(a(),w("div",{key:C.id,class:"col-12 col-md-6 q-pa-sm"},[l(fe,{modification:C,"hide-price":s.viewOnly},{default:n(()=>[l(ee,{"view-only":s.viewOnly,count:e.value.get(C.id)||0,onIncrement:Q=>O(C.id),onDecrement:Q=>$(C.id)},null,8,["view-only","count","onIncrement","onDecrement"])]),_:2},1032,["modification","hide-price"])]))),128))])]),_:1})):f("",!0)],512)):f("",!0),s.viewOnly?f("",!0):(a(),w(E,{key:1},[l(X),l(_,{class:"row"},{default:n(()=>[l(M),z((a(),v(S,{color:"primary",onClick:b},{default:n(()=>[k(g(p(t).addToOrderButton),1)]),_:1})),[[N]])]),_:1})],64))]),_:1})]),_:1},8,["transition-hide"]))}});export{Qe as _,me as a,he as b};
