import{Q as U}from"./QInput.7bd0947e.js";import{Q as S,a as E,b as v}from"./QItemLabel.e8e8f6f6.js";import{Q as z}from"./QSelect.c3432e18.js";import{Q as D}from"./QCardSection.6b30cd69.js";import{Q as M}from"./QCard.05af6174.js";import{d as F,u as P,a as $,c as j,r as N,h as c,bc as G,o as _,i as H,k as a,g as s,e as Q,w as t,bC as O,bD as W,aw as X,ax as Y,bE as C,f,t as n,ac as J,aU as K,aV as Z,j as ee,n as T}from"./index.92b1981f.js";import{Q as ae,o as te}from"./on-form-validation-error.f0562acd.js";import{u as le,C as w,B as se}from"./BigSpinner.23930169.js";import{c as oe}from"./fuzzy-search.950e6fed.js";import{_ as ie}from"./BackButton.20001037.js";import"./use-dark.f27ed271.js";import"./focus-manager.05708ea9.js";import"./QChip.ac7925f0.js";import"./QMenu.27788fe4.js";import"./position-engine.f880795b.js";import"./QDialog.cd420016.js";import"./focusout.ff3e1aa2.js";import"./format.2a3572e1.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./QTooltip.320304f6.js";const re={class:"max-w-sm q-mx-auto"},ue={class:"row justify-end q-gutter-sm q-mt-md"},Be=F({__name:"AdminCreateUpdateDiningTable",setup(ne){const r=P(),m=$(),b=j(),g=N(!1),d=N(""),y=c(()=>b.currentRoute.value.params.id),u=c(()=>y.value?m.state.diningTables.tables.find(o=>o.id===y.value):void 0),B=c(()=>[w.EMPLOYEES,w.DINING_TABLES]),h=N(""),l=N(),I=c(()=>oe(m.state.employees.employees,["firstName","lastName","email"])),L=c(()=>I.value.search(h.value).map(o=>({...o,label:o.lastName+" "+o.firstName})));let x=le(B,{store:m});const q=G(()=>{u.value?(d.value=u.value.number,l.value={...u.value.employee,label:u.value.employee.lastName+" "+u.value.employee.firstName},q()):y.value&&m.state.diningTables.tables.length&&b.push("/404")},{flush:"post"}),A=(o,i)=>{i(()=>{h.value=o})},R=async()=>{var o,i,e,p,V,k;g.value=!0,m.commit.sync(u.value?O({table:{id:u.value.id,number:d.value,employee:{id:(o=l.value)==null?void 0:o.id,firstName:(i=l.value)==null?void 0:i.firstName,lastName:(e=l.value)==null?void 0:e.lastName}}}):W({table:{number:d.value,employee:{id:(p=l.value)==null?void 0:p.id,firstName:(V=l.value)==null?void 0:V.firstName,lastName:(k=l.value)==null?void 0:k.lastName}}})).then(()=>{X.create({type:"positive",position:"top",timeout:Y,message:u.value?r.value.updateSuccess:r.value.createSuccess,multiLine:!0,group:!1}),b.push("/admin/dining-tables")}).finally(()=>{g.value=!1})};return(o,i)=>(_(),H("div",re,[a(ie),s(x)?(_(),Q(se,{key:0})):(_(),Q(ae,{key:1,onSubmit:R,onValidationError:s(te)},{default:t(()=>[a(M,{class:"q-pa-md"},{default:t(()=>[a(D,{class:"q-gutter-lg"},{default:t(()=>[a(U,{modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=e=>d.value=e),modelModifiers:{trim:!0},"stack-label":"",label:`${s(r).tableNumberLabel} *`,"lazy-rules":"",type:"text",rules:[e=>!!e&&e.length>0||s(r).fieldRequired,e=>e.length<=s(C)||s(r).maxLength({max:s(C)})]},null,8,["modelValue","label","rules"]),a(z,{modelValue:l.value,"onUpdate:modelValue":i[1]||(i[1]=e=>l.value=e),"use-input":"","fill-input":"","stack-label":"",clearable:"","hide-selected":"","input-debounce":"0",options:L.value,onFilter:A,label:`${s(r).waiter} *`,rules:[e=>!!e||s(r).fieldRequired]},{selected:t(()=>[l.value?(_(),Q(S,{key:0},{default:t(()=>[a(E,null,{default:t(()=>[a(v,null,{default:t(()=>{var e,p;return[f(n((e=l.value)==null?void 0:e.lastName)+" "+n((p=l.value)==null?void 0:p.firstName),1)]}),_:1}),a(v,{caption:""},{default:t(()=>{var e;return[f(n((e=l.value)==null?void 0:e.email),1)]}),_:1})]),_:1})]),_:1})):J("",!0)]),option:t(e=>[a(S,K(Z(e.itemProps)),{default:t(()=>[a(E,null,{default:t(()=>[a(v,null,{default:t(()=>[f(n(e.opt.lastName)+" "+n(e.opt.firstName),1)]),_:2},1024),a(v,{caption:""},{default:t(()=>[f(n(e.opt.email),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":t(()=>[a(S,null,{default:t(()=>[a(E,null,{default:t(()=>[f(n(s(r).noResults),1)]),_:1})]),_:1})]),_:1},8,["modelValue","options","label","rules"])]),_:1})]),_:1}),ee("div",ue,[a(T,{label:s(r).cancel,onClick:i[2]||(i[2]=()=>s(b).back()),color:"dark",flat:""},null,8,["label"]),a(T,{label:s(r).save,loading:g.value,type:"submit",color:"primary"},null,8,["label","loading"])])]),_:1},8,["onValidationError"]))]))}});export{Be as default};
