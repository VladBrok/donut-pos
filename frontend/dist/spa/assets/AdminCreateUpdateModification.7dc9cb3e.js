import{Q as g}from"./QInput.7bd0947e.js";import{Q as U}from"./QCardSection.6b30cd69.js";import{Q as F}from"./QCard.05af6174.js";import{d as R,u as q,a as B,c as Q,r as u,h as I,bc as D,o as _,i as L,k as i,g as a,e as C,w as M,aw as y,az as $,bp as z,bq as H,ax as G,br as V,bs as S,bt as E,bu as N,bv as T,j as W,n as O}from"./index.92b1981f.js";import{Q as X,o as j}from"./on-form-validation-error.f0562acd.js";import{u as P,C as J,B as K}from"./BigSpinner.23930169.js";import{a as Y,w}from"./currency.2af12bed.js";import{_ as Z}from"./BackButton.20001037.js";import{b as ee,_ as ae}from"./blob-to-base64.f508cabb.js";import"./use-dark.f27ed271.js";import"./focus-manager.05708ea9.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./QTooltip.320304f6.js";import"./position-engine.f880795b.js";import"./QImg.d5d2e26d.js";import"./QChip.ac7925f0.js";import"./format.2a3572e1.js";const le={class:"max-w-md q-mx-auto"},te={class:"row justify-end q-gutter-sm q-mt-md"},ye=R({__name:"AdminCreateUpdateModification",setup(oe){const l=q(),d=B(),p=Q(),b=u(!1),r=u(""),c=u(""),f=u(),n=u(""),m=u(""),v=I(()=>p.currentRoute.value.params.id),o=I(()=>v.value?d.state.modifications.modifications.find(s=>s.id===v.value):void 0),A=I(()=>v.value&&!o.value?[J.MODIFICATIONS]:[]);let x=P(A,{store:d});const k=D(()=>{o.value?(r.value=o.value.name,c.value=o.value.imageUrl,n.value=Y(o.value.price),m.value=o.value.weight,k()):v.value&&d.state.modifications.modifications.length&&p.push("/404")},{flush:"post"}),h=async()=>{let s="";try{c.value&&f.value&&(s=await ee(f.value))}catch{y.create({type:"negative",position:"top",timeout:$,message:l.value.imageCorrupted,multiLine:!0,group:!1});return}b.value=!0,d.commit.sync(o.value?z({id:o.value.id,name:r.value,price:w(+n.value||0),imageBase64:s,weight:+m.value||0}):H({name:r.value,price:w(+n.value||0),imageBase64:s,weight:+m.value||0})).then(()=>{y.create({type:"positive",position:"top",timeout:G,message:o.value?l.value.updateSuccess:l.value.createSuccess,multiLine:!0,group:!1}),p.push("/admin/modifications")}).finally(()=>{b.value=!1})};return(s,t)=>(_(),L("div",le,[i(Z),a(x)?(_(),C(K,{key:0})):(_(),C(X,{key:1,onSubmit:h,onValidationError:a(j)},{default:M(()=>[i(F,{class:"q-pa-md"},{default:M(()=>[i(U,{class:"q-gutter-lg"},{default:M(()=>[i(ae,{url:c.value,"onUpdate:url":t[0]||(t[0]=e=>c.value=e),file:f.value,"onUpdate:file":t[1]||(t[1]=e=>f.value=e)},null,8,["url","file"]),i(g,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e),modelModifiers:{trim:!0},"stack-label":"",label:`${a(l).modificationNameLabel} *`,"lazy-rules":"",type:"text",rules:[e=>!!e&&e.length>0||a(l).fieldRequired,e=>e.length<=a(V)||a(l).maxLength({max:a(V)})]},null,8,["modelValue","label","rules"]),i(g,{modelValue:n.value,"onUpdate:modelValue":t[3]||(t[3]=e=>n.value=e),modelModifiers:{number:!0},"stack-label":"",label:`${a(l).price} *`,"lazy-rules":"",type:"number",step:"0.01",rules:[e=>e!==""||a(l).fieldRequired,e=>e<=a(S)||a(l).maxValue({max:a(S)}),e=>e>=a(E)||a(l).minValue({min:a(E)})]},null,8,["modelValue","label","rules"]),i(g,{modelValue:m.value,"onUpdate:modelValue":t[4]||(t[4]=e=>m.value=e),modelModifiers:{number:!0},"stack-label":"",label:`${a(l).weight} *`,"lazy-rules":"",type:"number",step:"1",rules:[e=>e!==""||a(l).fieldRequired,e=>e<=a(N)||a(l).maxValue({max:a(N)}),e=>e>=a(T)||a(l).minValue({min:a(T)})]},null,8,["modelValue","label","rules"])]),_:1})]),_:1}),W("div",te,[i(O,{label:a(l).cancel,onClick:t[5]||(t[5]=()=>a(p).back()),color:"dark",flat:""},null,8,["label"]),i(O,{label:a(l).save,loading:b.value,type:"submit",color:"primary"},null,8,["label","loading"])])]),_:1},8,["onValidationError"]))]))}});export{ye as default};
