import{Q as I}from"./QSpace.472bcaca.js";import{d as Q,h as $,a as T,u as P,r as C,H as O,e as y,w as t,o as m,k as e,a5 as g,n as h,g as a,j as v,t as p,ag as V,aY as z,A as F,aZ as W,a_ as Y,aC as H,a$ as j,i as x,ai as A,f as w,m as G,am as K,b0 as Z,b1 as J,aA as X,aB as ee,b2 as te,b3 as ae,ay as B}from"./index.1c3783dc.js";import{Q as f}from"./QCardSection.ef6e6dbe.js";import{Q as N}from"./QCard.5aa3fe54.js";import{Q as M}from"./QDialog.69ef5705.js";import{C as q}from"./ClosePopup.76c7f815.js";import{B as D}from"./BigSpinner.fa6acb5e.js";import{b as le}from"./browser.1a1bd576.js";import{Q as oe}from"./QImg.7b74f12e.js";import{Q as L,b as se,a as re}from"./QItemLabel.b64ba62a.js";import{Q as ne}from"./QList.ba5e3c57.js";import{Q as ue}from"./QInput.e35961c4.js";import{Q as de,o as ie}from"./on-form-validation-error.73894483.js";import{f as E,w as R}from"./currency.2af12bed.js";const me={class:"text-center"},ce={class:"text-h5 q-mb-sm"},pe={class:"text-body1 text-dark-gray q-mb-md"},fe=Q({__name:"ClientDineInCashPaymentModal",props:{orderId:{},modelValue:{type:Boolean}},emits:["close","update:modelValue"],setup(_,{emit:c}){const r=_,n=$(()=>r.modelValue),s=c,u=T(),i=P(),o=C(!1),l=C(!1);return O(n,()=>{!n.value||(o.value=!0,u.commit.sync(z({orderId:r.orderId})).then(()=>{l.value=!0}).catch(()=>{l.value=!1}).finally(()=>{o.value=!1}))},{immediate:!0}),(d,b)=>(m(),y(M,{"model-value":n.value,"onUpdate:modelValue":b[0]||(b[0]=k=>s("update:modelValue",k))},{default:t(()=>[e(N,{class:"dialog-sm q-pb-md q-px-md"},{default:t(()=>[e(f,{class:"row items-center q-pb-none"},{default:t(()=>[e(I),g(e(h,{icon:"close",flat:"",round:"",dense:"",title:a(i).close},null,8,["title"]),[[q]])]),_:1}),o.value?(m(),y(D,{key:0})):l.value?(m(),y(f,{key:1},{default:t(()=>[v("div",me,[v("p",ce,p(a(i).waiterWasCalled),1),v("p",pe,p(a(i).waiterWillAcceptPayment),1),g(e(h,{label:a(i).ok,color:"primary",class:"q-mx-auto d-block"},null,8,["label"]),[[q]])])]),_:1})):V("",!0)]),_:1})]),_:1},8,["model-value"]))}}),ve={class:"text-center"},ye={class:"text-h5 q-mb-lg"},_e=Q({__name:"ClientTakeoutDeliveryCashPaymentModal",props:{modelValue:{type:Boolean}},emits:["close","update:modelValue"],setup(_,{emit:c}){const r=_,n=$(()=>r.modelValue),s=c,u=P();return(i,o)=>(m(),y(M,{"model-value":n.value,"onUpdate:modelValue":o[0]||(o[0]=l=>s("update:modelValue",l))},{default:t(()=>[e(N,{class:"dialog-sm q-pb-md q-px-md"},{default:t(()=>[e(f,{class:"row items-center q-pb-none"},{default:t(()=>[e(I),g(e(h,{icon:"close",flat:"",round:"",dense:"",title:a(u).close},null,8,["title"]),[[q]])]),_:1}),e(f,null,{default:t(()=>[v("div",ve,[v("p",ye,p(a(u).payInCashUponReceipt),1),g(e(h,{label:a(u).ok,color:"primary",class:"q-mx-auto d-block"},null,8,["label"]),[[q]])])]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),be={key:0,class:"text-h4 text-center q-mb-md"},Ce={key:1},ge=Q({__name:"PaymentCard",props:{orderNumber:{},method:{}},setup(_){const c=_,r=P(),n=C(!1),s=T(),u=$(()=>s.state.orders.paymentLink),i=C(),o=$(()=>{var d;return(d=s.state.auth.user.permissions)==null?void 0:d.client});F(async()=>{var d,b;(d=i.value)==null||d.replaceChildren(),n.value=!0;try{if(await l(),W("paymentLink:",u.value),Y(u.value,"payment link was not received"),o.value)window.open(u.value,"_self");else try{const k=await le.toCanvas(u.value,{errorCorrectionLevel:"M",version:14,width:280});(b=i.value)==null||b.appendChild(k)}catch(k){H("QR code generation error:",k)}}finally{n.value=!1}});async function l(){return await s.commit.sync(j({orderNumber:c.orderNumber,method:c.method}))}return(d,b)=>(m(),x(A,null,[e(f,null,{default:t(()=>[n.value?V("",!0):(m(),x("p",be,p(o.value?a(r).clickToPay:a(r).scanQrCode),1))]),_:1}),e(f,null,{default:t(()=>[n.value?(m(),y(D,{key:0})):V("",!0),v("div",{ref_key:"qrCodeContainer",ref:i,class:"w-fit q-mx-auto"},null,512),!n.value&&o.value?(m(),x("div",Ce,[e(h,{color:"primary",class:"q-mx-auto d-block w-fit",href:u.value},{default:t(()=>[w(p(a(r).pay),1)]),_:1},8,["href"])])):V("",!0)]),_:1})],64))}}),he=Q({__name:"CreditCardOrBlikPaymentModal",props:{orderNumber:{},modelValue:{type:Boolean},method:{}},emits:["update:modelValue"],setup(_,{emit:c}){const r=_,n=c,s=P(),u=$(()=>r.modelValue);return(i,o)=>(m(),y(M,{maximized:"","model-value":u.value,"onUpdate:modelValue":o[0]||(o[0]=l=>n("update:modelValue",l))},{default:t(()=>[e(N,{class:"q-pb-sm"},{default:t(()=>[e(f,{class:"row items-center q-pb-none"},{default:t(()=>[e(I),g(e(h,{icon:"close",flat:"",round:"",dense:"",size:"lg",title:a(s).close},null,8,["title"]),[[q]])]),_:1}),u.value?(m(),y(ge,{key:0,"order-number":i.orderNumber,method:i.method},null,8,["order-number","method"])):V("",!0)]),_:1})]),_:1},8,["model-value"]))}}),U=Q({__name:"PaymentMethodCard",props:{imageSrc:{}},emits:["click"],setup(_,{emit:c}){const r=c,n=P();return(s,u)=>(m(),x("div",null,[e(ne,{bordered:"",separator:"",class:"rounded-borders"},{default:t(()=>[g((m(),y(re,{clickable:"",class:"q-px-md q-py-sm",onClick:u[0]||(u[0]=i=>r("click")),title:a(n).close},{default:t(()=>[e(L,{avatar:"",class:"q-mr-xs"},{default:t(()=>[e(oe,{src:s.imageSrc,alt:"",fit:"contain",class:"image-xs-sm"},null,8,["src"])]),_:1}),e(L,null,{default:t(()=>[e(se,{class:"text-weight-bold text-h6"},{default:t(()=>[G(s.$slots,"text")]),_:3})]),_:3})]),_:3},8,["title"])),[[K],[q]])]),_:3})]))}}),ke={class:"text-h5 text-center"},Ve={class:"text-h5"},qe={class:"text-primary"},xe={class:"text-h5"},we={key:0,class:"text-primary"},$e={key:1},Qe=Q({__name:"WaiterCashPaymentModal",props:{totalCost:{},orderNumber:{}},emits:["close","paid"],setup(_,{emit:c}){const r=_,n=c,s=P(),u=C(""),i=$(()=>Math.max(R(+u.value)-r.totalCost,0)),o=C(!1),l=T();async function d(){o.value=!0,l.commit.sync(J({orderNumber:r.orderNumber})).then(()=>{X.create({type:"positive",position:"top",timeout:ee,message:s.value.paymentSuccess,multiLine:!0,group:!1}),n("close"),n("paid")}).finally(()=>{o.value=!1})}return(b,k)=>(m(),y(M,null,{default:t(()=>[e(N,{class:"dialog-sm q-pb-md q-px-md"},{default:t(()=>[e(f,{class:"row items-center q-pb-none"},{default:t(()=>[e(I),g(e(h,{icon:"close",flat:"",round:"",dense:"",title:a(s).close},null,8,["title"]),[[q]])]),_:1}),e(f,null,{default:t(()=>[v("p",ke,p(a(s).payWithCash),1)]),_:1}),e(f,null,{default:t(()=>[v("p",Ve,[w(p(a(s).totalToPay)+": ",1),v("span",qe,p(a(E)(b.totalCost)),1)])]),_:1}),e(de,{onSubmit:d,onValidationError:a(ie)},{default:t(()=>[e(f,null,{default:t(()=>[e(ue,{modelValue:u.value,"onUpdate:modelValue":k[0]||(k[0]=S=>u.value=S),modelModifiers:{number:!0},"stack-label":"",label:`${a(s).amount} *`,hint:a(s).amountHint,"lazy-rules":"",type:"number",step:"0.01",rules:[S=>S!==""||a(s).fieldRequired,S=>a(R)(S)>=b.totalCost||a(s).minValue({min:a(E)(b.totalCost)})]},null,8,["modelValue","label","hint","rules"])]),_:1}),e(f,null,{default:t(()=>[v("p",xe,[w(p(a(s).change)+": ",1),i.value>0?(m(),x("span",we,p(a(E)(i.value)),1)):(m(),x("span",$e,"-"))]),g(v("p",{class:"text-caption text-negative q-mt-xs"},p(a(s).makeSureChangeGiven),513),[[Z,i.value>0]])]),_:1}),e(f,{align:"center"},{default:t(()=>[e(h,{color:"primary",type:"submit",class:"q-px-lg",loading:o.value},{default:t(()=>[w(p(a(s).pay),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["onValidationError"])]),_:1})]),_:1}))}}),Pe={class:"text-h5 text-center"},Fe=Q({__name:"PaymentMethodsModal",props:{totalCost:{},orderNumber:{},orderId:{},orderType:{}},setup(_){const c=P(),r=C(!1),n=C(!1),s=C("card"),u=T(),i=$(()=>{var o;return(o=u.state.auth.user.permissions)==null?void 0:o.client});return(o,l)=>(m(),x(A,null,[e(M,te(ae(o.$attrs)),{default:t(()=>[e(N,{class:"dialog-sm q-pb-md q-px-md"},{default:t(()=>[e(f,{class:"row items-center q-pb-none"},{default:t(()=>[e(I),g(e(h,{icon:"close",flat:"",round:"",dense:"",title:a(c).close},null,8,["title"]),[[q]])]),_:1}),e(f,null,{default:t(()=>[v("p",Pe,p(a(c).selectPaymentMethod),1)]),_:1}),e(f,null,{default:t(()=>[e(U,{"image-src":"/images/cash.svg",onClick:l[0]||(l[0]=d=>r.value=!0)},{text:t(()=>[w(p(a(c).cash),1)]),_:1}),e(U,{class:"q-mt-lg","image-src":"/images/credit-card.svg",onClick:l[1]||(l[1]=d=>{s.value="card",n.value=!0})},{text:t(()=>[w(p(a(c).creditCard),1)]),_:1}),e(U,{class:"q-mt-lg","image-src":"/images/blik.png",onClick:l[2]||(l[2]=d=>{s.value="blik",n.value=!0})},{text:t(()=>[w(p(a(c).blik),1)]),_:1})]),_:1})]),_:1})]),_:1},16),i.value?V("",!0):(m(),y(Qe,{key:0,modelValue:r.value,"onUpdate:modelValue":l[3]||(l[3]=d=>r.value=d),onClose:l[4]||(l[4]=d=>r.value=!1),"total-cost":o.totalCost,"order-number":o.orderNumber},null,8,["modelValue","total-cost","order-number"])),i.value&&o.orderType===a(B).DINE_IN?(m(),y(fe,{key:1,modelValue:r.value,"onUpdate:modelValue":l[5]||(l[5]=d=>r.value=d),onClose:l[6]||(l[6]=d=>r.value=!1),"order-id":o.orderId},null,8,["modelValue","order-id"])):V("",!0),i.value&&(o.orderType===a(B).TAKEOUT||o.orderType===a(B).DELIVERY)?(m(),y(_e,{key:2,modelValue:r.value,"onUpdate:modelValue":l[7]||(l[7]=d=>r.value=d),onClose:l[8]||(l[8]=d=>r.value=!1)},null,8,["modelValue"])):V("",!0),e(he,{modelValue:n.value,"onUpdate:modelValue":l[9]||(l[9]=d=>n.value=d),"order-number":o.orderNumber,method:s.value},null,8,["modelValue","order-number","method"])],64))}});export{Fe as _,Qe as a};
