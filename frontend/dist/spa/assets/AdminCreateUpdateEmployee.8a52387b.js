import{Q as V}from"./QInput.3643c48a.js";import{a as w,Q as B}from"./QItemLabel.088c8266.js";import{Q as U}from"./QSelect.ca5ceab2.js";import{Q as I}from"./QCardSection.d98f4e99.js";import{Q as T}from"./QCard.6ae2900c.js";import{d as z,u as F,a as $,c as O,r as i,h as f,bh as H,i as j,k as s,g as a,e as g,w as m,bC as D,bD as G,aB as X,aC as P,o as S,bE as Q,bF as h,f as Y,t as J,j as K,n as k}from"./index.0dcec281.js";import{Q as W,o as Z}from"./on-form-validation-error.720cb8a3.js";import{u as ee,C as _,B as ae}from"./BigSpinner.2e1aebfa.js";import{_ as le}from"./EmailInput.67d8ff74.js";import{c as te}from"./fuzzy-search.950e6fed.js";import{_ as oe}from"./BackButton.13f7a2cb.js";import{_ as se}from"./PasswordInput.a043177a.js";import"./use-dark.f3cc31f6.js";import"./focus-manager.05708ea9.js";import"./QChip.87f087fd.js";import"./QMenu.b9d6bbc5.js";import"./position-engine.039e47cb.js";import"./portal.1e339704.js";import"./QDialog.c45abf5d.js";import"./focusout.5531236c.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./CommonTooltip.9835515d.js";const re={class:"max-w-md q-mx-auto"},ue={class:"row justify-end q-gutter-sm q-mt-md"},Le=z({__name:"AdminCreateUpdateEmployee",setup(ie){const t=F(),u=$(),v=O(),y=i(!1),n=i(""),d=i(""),p=i(""),c=i(""),b=i(""),N=f(()=>v.currentRoute.value.params.id),r=f(()=>N.value?u.state.employees.employees.find(o=>o.id===N.value):void 0),x=f(()=>N.value&&!r.value?[_.EMPLOYEES,_.ROLES]:[_.ROLES]);let C=ee(x,{store:u});const R=f(()=>te(u.state.roles.roles,["codeName"])),E=i(""),q=f(()=>R.value.search(E.value).map(o=>o.codeName)),L=H(()=>{var o;r.value?(n.value=((o=r.value.role)==null?void 0:o.codeName)||"",d.value=r.value.firstName,p.value=r.value.lastName,c.value=r.value.email,L()):N.value&&u.state.employees.employees.length&&v.push("/404")},{flush:"post"}),A=(o,l)=>{l(()=>{E.value=o})},M=async()=>{y.value=!0,u.commit.sync(r.value?D({id:r.value.id,firstName:d.value,lastName:p.value,password:b.value,email:c.value,role:u.state.roles.roles.find(o=>o.codeName===n.value)}):G({firstName:d.value,lastName:p.value,password:b.value,email:c.value,role:u.state.roles.roles.find(o=>o.codeName===n.value)})).then(()=>{X.create({type:"positive",position:"top",timeout:P,message:r.value?t.value.updateSuccess:t.value.createSuccess,multiLine:!0,group:!1}),v.push("/admin/employees")}).finally(()=>{y.value=!1})};return(o,l)=>(S(),j("div",re,[s(oe),a(C)?(S(),g(ae,{key:0})):(S(),g(W,{key:1,onSubmit:M,onValidationError:a(Z)},{default:m(()=>[s(T,{class:"q-pa-md"},{default:m(()=>[s(I,{class:"q-gutter-lg"},{default:m(()=>[s(V,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=e=>d.value=e),modelModifiers:{trim:!0},"stack-label":"",label:`${a(t).firstName} *`,"lazy-rules":"",type:"text",rules:[e=>!!e&&e.length>0||a(t).fieldRequired,e=>e.length<=a(Q)||a(t).maxLength({max:a(Q)})]},null,8,["modelValue","label","rules"]),s(V,{modelValue:p.value,"onUpdate:modelValue":l[1]||(l[1]=e=>p.value=e),modelModifiers:{trim:!0},"stack-label":"",label:`${a(t).lastName} *`,"lazy-rules":"",type:"text",rules:[e=>!!e&&e.length>0||a(t).fieldRequired,e=>e.length<=a(h)||a(t).maxLength({max:a(h)})]},null,8,["modelValue","label","rules"]),s(U,{modelValue:n.value,"onUpdate:modelValue":l[2]||(l[2]=e=>n.value=e),"use-input":"","fill-input":"","stack-label":"",clearable:"","hide-selected":"","input-debounce":"0",options:q.value,onFilter:A,label:`${a(t).role} *`,rules:[e=>!!e||a(t).fieldRequired]},{"no-option":m(()=>[s(w,null,{default:m(()=>[s(B,null,{default:m(()=>[Y(J(a(t).noResults),1)]),_:1})]),_:1})]),_:1},8,["modelValue","options","label","rules"]),s(le,{modelValue:c.value,"onUpdate:modelValue":l[3]||(l[3]=e=>c.value=e)},null,8,["modelValue"]),s(se,{modelValue:b.value,"onUpdate:modelValue":l[4]||(l[4]=e=>b.value=e),"should-validate-format":"",required:!r.value},null,8,["modelValue","required"])]),_:1})]),_:1}),K("div",ue,[s(k,{label:a(t).cancel,onClick:l[5]||(l[5]=()=>a(v).back()),color:"dark",flat:""},null,8,["label"]),s(k,{label:a(t).save,loading:y.value,type:"submit",color:"primary"},null,8,["label","loading"])])]),_:1},8,["onValidationError"]))]))}});export{Le as default};
