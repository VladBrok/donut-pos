import{Q as U}from"./QInput.af205288.js";import{Q as A}from"./QTooltip.64d8fdeb.js";import{d as L,h as N,a8 as F,u as O,H as P,o as n,i as v,ai as R,ah as j,j as B,t as k,g as a,ag as m,e as f,w as s,k as r,f as Q,n as _,Q as J,a as G,c as X,r as g,bg as K,bL as Y,bM as Z,bN as E,aA as ee,aB as ae,bO as q}from"./index.3f3b8c57.js";import{a as le,Q as oe}from"./QItemLabel.b85da9a3.js";import{Q as te}from"./QSelect.dcdd87e0.js";import{Q as ie}from"./QToggle.cba84707.js";import{Q as ne}from"./QCardSection.1779170a.js";import{Q as re}from"./QCard.bbe847d6.js";import{Q as se,o as ue}from"./on-form-validation-error.a634981b.js";import{u as me,C as de,B as pe}from"./BigSpinner.f02a38f1.js";import{_ as fe}from"./AddAddressModal.1b9f025f.js";import{_ as ce}from"./EmailInput.e5ebc785.js";import{_ as ke}from"./PhoneInput.e5cc4833.js";import{d as p}from"./dayjs.min.78c0669c.js";import{f as y}from"./address.94d37a80.js";import{_ as ve}from"./BackButton.98d5d541.js";import"./use-dark.fca62a05.js";import"./focus-manager.05708ea9.js";import"./position-engine.8a5cdfb5.js";import"./QChip.e4eb7192.js";import"./QMenu.5622cc90.js";import"./QDialog.8f914458.js";import"./focusout.8d369a05.js";import"./use-checkbox.a27cc2ea.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./QSpace.b6962a17.js";import"./ClosePopup.880cf5c6.js";import"./capitalize.b0e9fa3f.js";const ge={class:"work-schedule-entry-left row items-center gap-sm no-wrap"},be={class:"work-schedule-day-of-week"},Se={key:0,class:"text-dark-gray text-no-wrap"},_e={key:3},Ve={key:0,class:"work-schedule-entry-right row items-center no-wrap gap-sm"},Te={key:0,class:"text-dark-gray text-no-wrap"},He={key:4},we=L({__name:"WorkSchedule",props:{schedule:{}},emits:["updateSchedule"],setup(x,{emit:u}){const V=x,T=u,b=N(()=>V.schedule),d=F([]),i=O();return P(d,()=>{T("updateSchedule",d)}),P(b,()=>{JSON.stringify(b.value)!==JSON.stringify(d)&&d.splice(0,d.length,...b.value)},{immediate:!0}),(H,w)=>(n(),v("div",null,[(n(!0),v(R,null,j(d,(e,S)=>(n(),v("div",{key:S,class:"work-schedule-entry no-wrap"},[B("div",ge,[B("div",be,k(a(i)[`dayOfWeekShort${e.dayOfWeek}`]),1),e.openingTime==null?(n(),v("p",Se,k(a(i).weekend),1)):m("",!0),e.openingTime==null?(n(),f(_,{key:1,flat:"",dense:"",color:"primary",icon:"add",onClick:l=>{e.openingTime="",e.closingTime=""}},{default:s(()=>[r(A,null,{default:s(()=>[Q(k(a(i).addWorkTime),1)]),_:1})]),_:2},1032,["onClick"])):m("",!0),e.openingTime!=null?(n(),f(U,{key:2,"hide-bottom-space":"","no-error-icon":"","lazy-rules":"",dense:"",modelValue:e.openingTime,"onUpdate:modelValue":l=>e.openingTime=l,mask:"time","reactive-rules":"",rules:["time",l=>!!l||a(i).fieldRequired,l=>!a(p)(e.closingTime,"HH:mm",!0).isValid()||a(p)(l,"HH:mm").isBefore(a(p)(e.closingTime,"HH:mm"))||a(i).openingTimeBeforeClosing,l=>!a(p)(e.breakStart,"HH:mm",!0).isValid()||a(p)(l,"HH:mm").isBefore(a(p)(e.breakStart,"HH:mm"))||a(i).openingTimeBeforeBreakStart]},null,8,["modelValue","onUpdate:modelValue","rules"])):m("",!0),e.openingTime!=null?(n(),v("span",_e,"\u2014")):m("",!0),e.openingTime!=null?(n(),f(U,{key:4,"hide-bottom-space":"","no-error-icon":"","lazy-rules":"",dense:"",modelValue:e.closingTime,"onUpdate:modelValue":l=>e.closingTime=l,mask:"time",rules:["time",l=>!!l||a(i).fieldRequired]},null,8,["modelValue","onUpdate:modelValue","rules"])):m("",!0),e.openingTime!=null?(n(),f(_,{key:5,flat:"",dense:"",color:"negative",icon:"close",onClick:l=>{e.openingTime=null,e.closingTime=null}},{default:s(()=>[r(A,null,{default:s(()=>[Q(k(a(i).removeWorkTime),1)]),_:1})]),_:2},1032,["onClick"])):m("",!0)]),e.openingTime!=null?(n(),v("div",Ve,[e.breakStart==null?(n(),v("p",Te,k(a(i).noLunchBreak),1)):m("",!0),e.breakStart==null?(n(),f(_,{key:1,flat:"",dense:"",color:"primary",icon:"add",onClick:l=>{e.breakStart="",e.breakEnd=""}},{default:s(()=>[r(A,null,{default:s(()=>[Q(k(a(i).addLunchBreak),1)]),_:1})]),_:2},1032,["onClick"])):m("",!0),e.breakStart!=null?(n(),f(J,{key:2,name:"o_restaurant_menu",style:{"font-size":"22px"}})):m("",!0),e.breakStart!=null?(n(),f(U,{key:3,"reactive-rules":"","hide-bottom-space":"","no-error-icon":"","lazy-rules":"",dense:"",modelValue:e.breakStart,"onUpdate:modelValue":l=>e.breakStart=l,mask:"time",rules:["time",l=>!!l||a(i).fieldRequired,l=>!a(p)(e.breakEnd,"HH:mm",!0).isValid()||a(p)(l,"HH:mm").isBefore(a(p)(e.breakEnd,"HH:mm"))||a(i).breakStartBeforeEnd]},null,8,["modelValue","onUpdate:modelValue","rules"])):m("",!0),e.breakStart!=null?(n(),v("span",He,"\u2014")):m("",!0),e.breakStart!=null?(n(),f(U,{key:5,"hide-bottom-space":"","no-error-icon":"","lazy-rules":"",dense:"","reactive-rules":"",modelValue:e.breakEnd,"onUpdate:modelValue":l=>e.breakEnd=l,mask:"time",rules:["time",l=>!!l||a(i).fieldRequired,l=>!a(p)(e.closingTime,"HH:mm",!0).isValid()||a(p)(l,"HH:mm").isBefore(a(p)(e.closingTime,"HH:mm"))||a(i).breakEndBeforeClosing]},null,8,["modelValue","onUpdate:modelValue","rules"])):m("",!0),e.breakStart!=null?(n(),f(_,{key:6,flat:"",dense:"",color:"negative",icon:"close",onClick:l=>{e.breakStart=null,e.breakEnd=null}},{default:s(()=>[r(A,null,{default:s(()=>[Q(k(a(i).removeLunchBreak),1)]),_:1})]),_:2},1032,["onClick"])):m("",!0)])):m("",!0)]))),128))]))}}),Ce={class:"max-w-md q-mx-auto"},Be={class:"q-mb-sm"},Qe={class:"row justify-end q-gutter-sm q-mt-md"},la=L({__name:"AdminCreateUpdateSalePoint",setup(x){const u=O(),V=G(),T=X(),b=g(!1),d=g(""),i=g(""),H=g(""),w=g(!1),e=g(),S=g(Array(7).fill(null).map((C,o)=>({openingTime:o===6?null:"",closingTime:o===6?null:"",breakStart:null,breakEnd:null,dayOfWeek:(o+1)%7}))),l=g(!1),$=N(()=>T.currentRoute.value.params.id),c=N(()=>$.value?V.state.salePoints.salePoints.find(C=>C.id===$.value):void 0),I=N(()=>$.value&&!c.value?[de.SALE_POINTS]:[]);let z=me(I,{store:V});const M=N(()=>[y(e.value)].filter(Boolean)),h=(C,o)=>{o(()=>{})},D=K(()=>{c.value?(d.value=c.value.name,H.value=c.value.email,i.value=c.value.phone,e.value=c.value.address,w.value=c.value.isDefault,S.value=c.value.workSchedule.slice().map(C=>({...C})),D()):$.value&&V.state.salePoints.salePoints.length&&T.push("/404")},{flush:"post"}),W=async()=>{b.value=!0,V.commit.sync(c.value?Y({salePoint:{id:c.value.id,name:d.value,address:e.value,email:H.value,workSchedule:S.value,isDefault:w.value,phone:i.value}}):Z({salePoint:{id:E(),name:d.value,address:e.value,email:H.value,workSchedule:S.value,isDefault:w.value,phone:i.value}})).then(()=>{ee.create({type:"positive",position:"top",timeout:ae,message:c.value?u.value.updateSuccess:u.value.createSuccess,multiLine:!0,group:!1}),T.push("/admin/sale-points")}).finally(()=>{b.value=!1})};return(C,o)=>(n(),v(R,null,[B("div",Ce,[r(ve),a(z)?(n(),f(pe,{key:0})):(n(),f(se,{key:1,onSubmit:W,onValidationError:a(ue)},{default:s(()=>[r(re,{class:"q-pa-md"},{default:s(()=>[r(ne,{class:"q-gutter-lg"},{default:s(()=>[r(U,{modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=t=>d.value=t),modelModifiers:{trim:!0},"stack-label":"",label:`${a(u).salePointNameLabel} *`,"lazy-rules":"",type:"text",rules:[t=>!!t&&t.length>0||a(u).fieldRequired,t=>t.length<=a(q)||a(u).maxLength({max:a(q)})]},null,8,["modelValue","label","rules"]),r(ce,{modelValue:H.value,"onUpdate:modelValue":o[1]||(o[1]=t=>H.value=t)},null,8,["modelValue"]),r(ke,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=t=>i.value=t),shouldValidateFormat:""},null,8,["modelValue"]),r(te,{"model-value":a(y)(e.value),"use-input":"","fill-input":"","stack-label":"","hide-selected":"","input-debounce":"0",options:M.value,onFilter:h,label:`${a(u).address} *`,rules:[t=>!!t&&t.length>0||a(u).fieldRequired]},{after:s(()=>[r(_,{round:"",dense:"",icon:"add",color:"primary",onClick:o[3]||(o[3]=t=>l.value=!0)},{default:s(()=>[r(A,null,{default:s(()=>[Q(k(a(u).addNewAddress),1)]),_:1})]),_:1})]),"no-option":s(()=>[r(le,null,{default:s(()=>[r(oe,null,{default:s(()=>[Q(k(a(u).noResults),1)]),_:1})]),_:1})]),_:1},8,["model-value","options","label","rules"]),r(ie,{modelValue:w.value,"onUpdate:modelValue":o[4]||(o[4]=t=>w.value=t),label:a(u).isDefault,size:"lg","left-label":""},null,8,["modelValue","label"]),B("div",null,[B("p",Be,k(a(u).workSchedule),1),r(we,{schedule:S.value,onUpdateSchedule:o[5]||(o[5]=t=>S.value=t)},null,8,["schedule"])])]),_:1})]),_:1}),B("div",Qe,[r(_,{label:a(u).cancel,onClick:o[6]||(o[6]=()=>a(T).back()),color:"dark",flat:""},null,8,["label"]),r(_,{label:a(u).save,loading:b.value,type:"submit",color:"primary"},null,8,["label","loading"])])]),_:1},8,["onValidationError"]))]),l.value?(n(),f(fe,{key:0,modelValue:l.value,"onUpdate:modelValue":o[7]||(o[7]=t=>l.value=t),onSubmit:o[8]||(o[8]=t=>(l.value=!1,e.value=t))},null,8,["modelValue"])):m("",!0)],64))}});export{la as default};
