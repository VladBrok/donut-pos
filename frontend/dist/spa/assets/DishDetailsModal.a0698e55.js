import{Q as A}from"./QSpace.e42e5dd1.js";import{u as Q,d as S,h as N,e as g,w as n,ak as D,o as a,j as m,k as l,i as C,t as f,ah as h,f as k,g as p,m as b,r as R,n as T,c8 as U,bX as x,a as F,H as L,a5 as M,aj as z,ai as V,aZ as G,bO as W}from"./index.ace378a9.js";import{Q as _}from"./QCardSection.13401d47.js";import{Q as X}from"./NoData.98b9ade5.js";import{Q as P}from"./QCard.37427ab1.js";import{Q as Z}from"./QDialog.bbfa6b16.js";import{C as E}from"./ClosePopup.60bd3158.js";import{C as q}from"./CommonTooltip.baab5057.js";import{s as J}from"./sanitize-html.328c4bb3.js";import{Q as K}from"./QImg.d9eb9b84.js";import{f as Y}from"./currency.2af12bed.js";import{_ as ee}from"./ProductCounter.e8908c84.js";function te(d){const o=Q();return`${d} ${o.value.weightGram}`}function oe(d,o){if(o<=0)throw new Error(`Max length ${o} should be > 0`);return d.length<=o?d:d.slice(0,o)+"..."}const ie={class:"column no-wrap full-height"},ne={key:0,class:"absolute-full text-h6 flex flex-center"},se={class:"row justify-between q-px-md"},ae={class:"text-body2 text-dark-gray"},re={key:0,class:"text-primary"},j=S({__name:"ProductCard",props:{price:{},weight:{},name:{},imageUrl:{},noShadow:{type:Boolean},textSize:{},caption:{}},setup(d){const o=d,i=N(()=>({"text-h5":!o.textSize||o.textSize==="lg","text-h6":o.textSize==="sm"}));return(t,u)=>(a(),g(P,{class:D([{"shadow-0":t.noShadow},"full-height"])},{default:n(()=>[m("div",ie,[l(_,null,{default:n(()=>[l(K,{src:t.imageUrl,alt:t.name,fit:"cover",class:"image-card shadow-3 rounded-borders product-card-image"},{default:n(()=>[t.caption?(a(),C("div",ne,f(t.caption),1)):h("",!0)]),_:1},8,["src","alt"])]),_:1}),m("div",se,[m("div",{class:D(["q-mr-sm",i.value])},[m("div",null,[k(f(t.textSize==="sm"?p(oe)(t.name,20):t.name)+" ",1),t.textSize==="sm"?(a(),g(q,{key:0},{default:n(()=>[k(f(t.name),1)]),_:1})):h("",!0)]),m("div",ae,f(p(te)(t.weight)),1)],2),m("div",{class:D(["flex-grow text-right",i.value])},[t.price?(a(),C("span",re,f(p(Y)(t.price)),1)):h("",!0),b(t.$slots,"right")],2)]),b(t.$slots,"default")])]),_:3},8,["class"]))}}),le=m("span",{class:"text-h5 q-pr-sm"},"+",-1),de=m("span",{class:"text-h5"},"+",-1),ce=["innerHTML"],ue={key:0},me=S({__name:"DishCard",props:{dish:{},expanded:{type:Boolean},hidePrice:{type:Boolean},count:{}},emits:["openDetailsClick","addClick"],setup(d,{emit:o}){const i=o,t=R(),u=Q();return(e,r)=>(a(),C("div",{ref_key:"containerRef",ref:t},[l(j,{"no-shadow":e.expanded,"image-url":e.dish.imageUrl,price:e.hidePrice?void 0:e.dish.price,weight:e.dish.weight,name:e.dish.name,caption:e.dish.isActive?void 0:p(u).outOfStock},{right:n(()=>[e.count!=null?(a(),C("span",ue," x "+f(e.count),1)):h("",!0)]),default:n(()=>[e.expanded?h("",!0):(a(),g(_,{key:0,class:"q-mt-auto row justify-end"},{default:n(()=>[e.dish.isActive?(a(),g(T,{key:0,color:"primary","icon-right":"shopping_basket",padding:"0 sm",class:"q-mr-md",onClick:r[0]||(r[0]=v=>i("openDetailsClick")),title:p(u).openDetails},{default:n(()=>[le,l(q,null,{default:n(()=>[k(f(p(u).openDetails),1)]),_:1})]),_:1},8,["title"])):h("",!0),e.dish.isActive?(a(),g(T,{key:1,color:"primary",padding:"0 sm",outline:"",onClick:r[1]||(r[1]=v=>i("addClick",t.value)),title:p(u).addToCurrentOrder},{default:n(()=>[de,l(q,null,{default:n(()=>[k(f(p(u).addToCurrentOrder),1)]),_:1})]),_:1},8,["title"])):h("",!0)]),_:1})),e.expanded&&e.dish.description?(a(),g(_,{key:1},{default:n(()=>[m("div",{class:"text-body1",innerHTML:p(J)(e.dish.description)},null,8,ce)]),_:1})):h("",!0)]),_:1},8,["no-shadow","image-url","price","weight","name","caption"])],512))}});function pe({timing:d,draw:o,duration:i}){const t=performance.now();requestAnimationFrame(function u(e){let r=(e-t)/i;r>1&&(r=1);const v=d(r);o(v),r<1&&requestAnimationFrame(u)})}function he(d,o,i){if(i){const t=i.querySelector(".product-card-image"),u=t==null?void 0:t.cloneNode(!0);if(t&&u){const e=u;e.style.position="absolute",document.body.appendChild(e);const r=t.getBoundingClientRect().left+document.documentElement.scrollLeft+15,v=t.getBoundingClientRect().top+document.documentElement.scrollTop-25,$=document.querySelector(".shopping-basket"),B=$.getBoundingClientRect().left+document.documentElement.scrollLeft+10-r,s=$.getBoundingClientRect().top+document.documentElement.scrollTop-10-v,c=t.getBoundingClientRect().width,y=t.getBoundingClientRect().height,O=c/4-c,H=y/4-y;e.style.left=`${r}px`,e.style.top=`${v}px`,e.style.width=`${t.getBoundingClientRect().width}px`,e.style.height=`${t.getBoundingClientRect().height}px`,e.style.zIndex="9999",pe({duration:x,timing:w=>w,draw:w=>{var I;e.style.left=`${r+B*w}px`,e.style.top=`${v+s*w}px`,e.style.width=`${c+O*w}px`,e.style.height=`${y+H*w}px`,e.style.opacity=(I=Math.max(1-w,.1))==null?void 0:I.toString(),w>=1&&e.remove()}})}}d.commit.crossTab(U({dish:o}))}const fe=S({__name:"ModificationCard",props:{modification:{},hidePrice:{type:Boolean}},setup(d){return(o,i)=>(a(),g(j,{"image-url":o.modification.imageUrl,price:o.hidePrice?void 0:o.modification.price,name:o.modification.name,weight:o.modification.weight,"text-size":"sm"},{default:n(()=>[l(_,{class:"q-mt-auto row justify-end"},{default:n(()=>[b(o.$slots,"default")]),_:3})]),_:3},8,["image-url","price","name","weight"]))}}),ge={class:"text-weight-bold text-h5"},ve={class:"q-mt-sm row"},Re=S({__name:"DishDetailsModal",props:{dish:{},viewOnly:{type:Boolean},count:{}},setup(d){const o=d,i=N(()=>o.dish),t=Q(),u=F(),e=R(new Map),r=R();L(i,()=>{var s;e.value.clear(),(s=i.value)==null||s.modifications.forEach(c=>{e.value.set(c.id,(c==null?void 0:c.count)||0)})},{immediate:!0});function v(s){e.value.set(s,(e.value.get(s)||0)-1)}function $(s){e.value.set(s,(e.value.get(s)||0)+1)}function B(){G(i.value,"Expected to have a dish at this point");const s={cookedDate:"",cookingDate:"",deliveredDate:"",status:"",count:1,dishIdInOrder:W(),...i.value,modifications:i.value.modifications.filter(c=>e.value.get(c.id)).map(c=>({...c,count:e.value.get(c.id)||-1}))};he(u,s,r.value)}return(s,c)=>(a(),g(Z,null,{default:n(()=>[l(P,{class:"dialog-md"},{default:n(()=>[l(_,{class:"row items-center q-pb-none"},{default:n(()=>[l(A),M(l(T,{icon:"close",flat:"",round:"",dense:"",title:p(t).close},null,8,["title"]),[[E]])]),_:1}),i.value?(a(),C("div",{key:0,class:"row scroll restricted-height-modal",ref_key:"dishContainerRef",ref:r},[m("div",{class:D(["col-12 col-sm-6",{"q-mx-auto":!i.value.modifications.length}])},[l(me,{dish:i.value,expanded:"","hide-price":s.viewOnly,count:s.count},null,8,["dish","hide-price","count"])],2),i.value.modifications.length?(a(),g(_,{key:0,class:"col-12 col-sm-6"},{default:n(()=>[m("div",ge,f(p(t).modificationsTitle)+": ",1),m("div",ve,[(a(!0),C(z,null,V(i.value.modifications,y=>(a(),C("div",{key:y.id,class:"col-12 col-md-6 q-pa-sm"},[l(fe,{modification:y,"hide-price":s.viewOnly},{default:n(()=>[l(ee,{"view-only":s.viewOnly,count:e.value.get(y.id)||0,onIncrement:O=>$(y.id),onDecrement:O=>v(y.id)},null,8,["view-only","count","onIncrement","onDecrement"])]),_:2},1032,["modification","hide-price"])]))),128))])]),_:1})):h("",!0)],512)):h("",!0),s.viewOnly?h("",!0):(a(),C(z,{key:1},[l(X),l(_,{class:"row"},{default:n(()=>[l(A),M((a(),g(T,{color:"primary",onClick:B},{default:n(()=>[k(f(p(t).addToOrderButton),1)]),_:1})),[[E]])]),_:1})],64))]),_:1})]),_:1}))}});export{Re as _,me as a,he as b};
