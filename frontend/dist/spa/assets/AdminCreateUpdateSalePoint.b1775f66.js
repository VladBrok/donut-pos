import{Q as A}from"./QInput.c820a074.js";import{Q as N}from"./QTooltip.2af661a3.js";import{d as y,h as U,a8 as F,u as O,H as L,o as n,i as v,ai as R,ah as j,j as C,t as k,g as e,ag as m,e as f,w as s,k as r,f as Q,n as _,Q as J,a as G,c as X,r as g,bg as K,bL as Y,bM as Z,bN as E,aA as ee,aB as le,bO as P}from"./index.9a4cab8b.js";import{a as ae,Q as oe}from"./QItemLabel.bfe7294f.js";import{Q as te}from"./QSelect.eb5ea9ac.js";import{Q as ie}from"./QToggle.38054411.js";import{Q as ne}from"./QCardSection.44124512.js";import{Q as re}from"./QCard.e5424a73.js";import{Q as se,o as ue}from"./on-form-validation-error.f1d5dce0.js";import{u as me,C as de,B as pe}from"./BigSpinner.84b43e9a.js";import{_ as fe}from"./AddAddressModal.62c55f1e.js";import{_ as ce}from"./EmailInput.aa49a0b9.js";import{_ as ke}from"./PhoneInput.583efe14.js";import{d as p}from"./dayjs.min.78c0669c.js";import{f as q}from"./address.94d37a80.js";import{_ as ve}from"./BackButton.6450ad9c.js";import"./use-dark.dcf125aa.js";import"./focus-manager.05708ea9.js";import"./position-engine.789805a8.js";import"./QChip.8355376c.js";import"./QMenu.f918919e.js";import"./QDialog.144d910d.js";import"./focusout.1a0cc56a.js";import"./use-checkbox.c2fea4b3.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./QSpace.e0f5dbfc.js";import"./ClosePopup.136dfd71.js";import"./capitalize.b0e9fa3f.js";const ge={class:"work-schedule-entry-left row items-center gap-sm no-wrap"},be={class:"work-schedule-day-of-week"},Se={key:0,class:"text-dark-gray text-no-wrap"},_e={key:3},Ve={key:0,class:"work-schedule-entry-right row items-center no-wrap gap-sm"},Te={key:0,class:"text-dark-gray text-no-wrap"},we={key:4},He=y({__name:"WorkSchedule",props:{schedule:{}},emits:["updateSchedule"],setup(x,{emit:u}){const V=x,T=u,b=U(()=>V.schedule),d=F([]),o=O();return L(d,()=>{T("updateSchedule",d)}),L(b,()=>{JSON.stringify(b.value)!==JSON.stringify(d)&&d.splice(0,d.length,...b.value)},{immediate:!0}),(w,H)=>(n(),v("div",null,[(n(!0),v(R,null,j(d,(l,S)=>(n(),v("div",{key:S,class:"work-schedule-entry no-wrap"},[C("div",ge,[C("div",be,k(e(o)[`dayOfWeekShort${l.dayOfWeek}`]),1),l.openingTime==null?(n(),v("p",Se,k(e(o).weekend),1)):m("",!0),l.openingTime==null?(n(),f(_,{key:1,flat:"",dense:"",color:"primary",icon:"add",onClick:a=>{l.openingTime="",l.closingTime=""},title:e(o).addWorkTime},{default:s(()=>[r(N,null,{default:s(()=>[Q(k(e(o).addWorkTime),1)]),_:1})]),_:2},1032,["onClick","title"])):m("",!0),l.openingTime!=null?(n(),f(A,{key:2,"hide-bottom-space":"","no-error-icon":"","lazy-rules":"",dense:"",modelValue:l.openingTime,"onUpdate:modelValue":a=>l.openingTime=a,mask:"time","reactive-rules":"",rules:["time",a=>!!a||e(o).fieldRequired,a=>!e(p)(l.closingTime,"HH:mm",!0).isValid()||e(p)(a,"HH:mm").isBefore(e(p)(l.closingTime,"HH:mm"))||e(o).openingTimeBeforeClosing,a=>!e(p)(l.breakStart,"HH:mm",!0).isValid()||e(p)(a,"HH:mm").isBefore(e(p)(l.breakStart,"HH:mm"))||e(o).openingTimeBeforeBreakStart]},null,8,["modelValue","onUpdate:modelValue","rules"])):m("",!0),l.openingTime!=null?(n(),v("span",_e,"\u2014")):m("",!0),l.openingTime!=null?(n(),f(A,{key:4,"hide-bottom-space":"","no-error-icon":"","lazy-rules":"",dense:"",modelValue:l.closingTime,"onUpdate:modelValue":a=>l.closingTime=a,mask:"time",rules:["time",a=>!!a||e(o).fieldRequired]},null,8,["modelValue","onUpdate:modelValue","rules"])):m("",!0),l.openingTime!=null?(n(),f(_,{key:5,flat:"",dense:"",color:"negative",icon:"close",onClick:a=>{l.openingTime=null,l.closingTime=null},title:e(o).removeWorkTime},{default:s(()=>[r(N,null,{default:s(()=>[Q(k(e(o).removeWorkTime),1)]),_:1})]),_:2},1032,["onClick","title"])):m("",!0)]),l.openingTime!=null?(n(),v("div",Ve,[l.breakStart==null?(n(),v("p",Te,k(e(o).noLunchBreak),1)):m("",!0),l.breakStart==null?(n(),f(_,{key:1,flat:"",dense:"",color:"primary",icon:"add",onClick:a=>{l.breakStart="",l.breakEnd=""},title:e(o).addLunchBreak},{default:s(()=>[r(N,null,{default:s(()=>[Q(k(e(o).addLunchBreak),1)]),_:1})]),_:2},1032,["onClick","title"])):m("",!0),l.breakStart!=null?(n(),f(J,{key:2,name:"o_restaurant_menu",style:{"font-size":"22px"}})):m("",!0),l.breakStart!=null?(n(),f(A,{key:3,"reactive-rules":"","hide-bottom-space":"","no-error-icon":"","lazy-rules":"",dense:"",modelValue:l.breakStart,"onUpdate:modelValue":a=>l.breakStart=a,mask:"time",rules:["time",a=>!!a||e(o).fieldRequired,a=>!e(p)(l.breakEnd,"HH:mm",!0).isValid()||e(p)(a,"HH:mm").isBefore(e(p)(l.breakEnd,"HH:mm"))||e(o).breakStartBeforeEnd]},null,8,["modelValue","onUpdate:modelValue","rules"])):m("",!0),l.breakStart!=null?(n(),v("span",we,"\u2014")):m("",!0),l.breakStart!=null?(n(),f(A,{key:5,"hide-bottom-space":"","no-error-icon":"","lazy-rules":"",dense:"","reactive-rules":"",modelValue:l.breakEnd,"onUpdate:modelValue":a=>l.breakEnd=a,mask:"time",rules:["time",a=>!!a||e(o).fieldRequired,a=>!e(p)(l.closingTime,"HH:mm",!0).isValid()||e(p)(a,"HH:mm").isBefore(e(p)(l.closingTime,"HH:mm"))||e(o).breakEndBeforeClosing]},null,8,["modelValue","onUpdate:modelValue","rules"])):m("",!0),l.breakStart!=null?(n(),f(_,{key:6,flat:"",dense:"",color:"negative",icon:"close",onClick:a=>{l.breakStart=null,l.breakEnd=null},title:e(o).removeLunchBreak},{default:s(()=>[r(N,null,{default:s(()=>[Q(k(e(o).removeLunchBreak),1)]),_:1})]),_:2},1032,["onClick","title"])):m("",!0)])):m("",!0)]))),128))]))}}),Be={class:"max-w-md q-mx-auto"},Ce={class:"q-mb-sm"},Qe={class:"row justify-end q-gutter-sm q-mt-md"},al=y({__name:"AdminCreateUpdateSalePoint",setup(x){const u=O(),V=G(),T=X(),b=g(!1),d=g(""),o=g(""),w=g(""),H=g(!1),l=g(),S=g(Array(7).fill(null).map((B,t)=>({openingTime:t===6?null:"",closingTime:t===6?null:"",breakStart:null,breakEnd:null,dayOfWeek:(t+1)%7}))),a=g(!1),$=U(()=>T.currentRoute.value.params.id),c=U(()=>$.value?V.state.salePoints.salePoints.find(B=>B.id===$.value):void 0),I=U(()=>$.value&&!c.value?[de.SALE_POINTS]:[]);let h=me(I,{store:V});const W=U(()=>[q(l.value)].filter(Boolean)),z=(B,t)=>{t(()=>{})},M=K(()=>{c.value?(d.value=c.value.name,w.value=c.value.email,o.value=c.value.phone,l.value=c.value.address,H.value=c.value.isDefault,S.value=c.value.workSchedule.slice().map(B=>({...B})),M()):$.value&&V.state.salePoints.salePoints.length&&T.push("/404")},{flush:"post"}),D=async()=>{b.value=!0,V.commit.sync(c.value?Y({salePoint:{id:c.value.id,name:d.value,address:l.value,email:w.value,workSchedule:S.value,isDefault:H.value,phone:o.value}}):Z({salePoint:{id:E(),name:d.value,address:l.value,email:w.value,workSchedule:S.value,isDefault:H.value,phone:o.value}})).then(()=>{ee.create({type:"positive",position:"top",timeout:le,message:c.value?u.value.updateSuccess:u.value.createSuccess,multiLine:!0,group:!1}),T.push("/admin/sale-points")}).finally(()=>{b.value=!1})};return(B,t)=>(n(),v(R,null,[C("div",Be,[r(ve),e(h)?(n(),f(pe,{key:0})):(n(),f(se,{key:1,onSubmit:D,onValidationError:e(ue)},{default:s(()=>[r(re,{class:"q-pa-md"},{default:s(()=>[r(ne,{class:"q-gutter-lg"},{default:s(()=>[r(A,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=i=>d.value=i),modelModifiers:{trim:!0},"stack-label":"",label:`${e(u).salePointNameLabel} *`,"lazy-rules":"",type:"text",rules:[i=>!!i&&i.length>0||e(u).fieldRequired,i=>i.length<=e(P)||e(u).maxLength({max:e(P)})]},null,8,["modelValue","label","rules"]),r(ce,{modelValue:w.value,"onUpdate:modelValue":t[1]||(t[1]=i=>w.value=i)},null,8,["modelValue"]),r(ke,{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=i=>o.value=i),shouldValidateFormat:""},null,8,["modelValue"]),r(te,{"model-value":e(q)(l.value),"use-input":"","fill-input":"","stack-label":"","hide-selected":"","input-debounce":"0",options:W.value,onFilter:z,label:`${e(u).address} *`,rules:[i=>!!i&&i.length>0||e(u).fieldRequired]},{after:s(()=>[r(_,{round:"",dense:"",icon:"add",color:"primary",onClick:t[3]||(t[3]=i=>a.value=!0),title:e(u).addNewAddress},{default:s(()=>[r(N,null,{default:s(()=>[Q(k(e(u).addNewAddress),1)]),_:1})]),_:1},8,["title"])]),"no-option":s(()=>[r(ae,null,{default:s(()=>[r(oe,null,{default:s(()=>[Q(k(e(u).noResults),1)]),_:1})]),_:1})]),_:1},8,["model-value","options","label","rules"]),r(ie,{modelValue:H.value,"onUpdate:modelValue":t[4]||(t[4]=i=>H.value=i),label:e(u).isDefault,size:"lg","left-label":""},null,8,["modelValue","label"]),C("div",null,[C("p",Ce,k(e(u).workSchedule),1),r(He,{schedule:S.value,onUpdateSchedule:t[5]||(t[5]=i=>S.value=i)},null,8,["schedule"])])]),_:1})]),_:1}),C("div",Qe,[r(_,{label:e(u).cancel,onClick:t[6]||(t[6]=()=>e(T).back()),color:"dark",flat:""},null,8,["label"]),r(_,{label:e(u).save,loading:b.value,type:"submit",color:"primary"},null,8,["label","loading"])])]),_:1},8,["onValidationError"]))]),a.value?(n(),f(fe,{key:0,modelValue:a.value,"onUpdate:modelValue":t[7]||(t[7]=i=>a.value=i),onSubmit:t[8]||(t[8]=i=>(a.value=!1,l.value=i))},null,8,["modelValue"])):m("",!0)],64))}});export{al as default};
