import{d as S,h as m,u as $,a as x,r as N,e as i,w as a,g as n,bW as B,cn as V,o as t,f as k,t as y,n as b,i as C,k as c,j as f,ah as w,cc as I,aj as q,ai as E}from"./index.e78f07d2.js";import{u as M,C as R,B as U}from"./BigSpinner.12aaa730.js";import{Q as O}from"./QInput.5e01f4a0.js";import{a as A}from"./get-order-total-cost.c30b6c87.js";import{C as D}from"./CommonTooltip.0edc01ee.js";import{_ as Q}from"./OrderNumberTitle.e800051e.js";import{_ as T}from"./OrderView.765dd0bc.js";import{_ as j}from"./PaymentMethodsModal.a327a2c2.js";import{f as F,m as G}from"./address.b5e3391c.js";import{_ as L}from"./NoData.bf12ea80.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./use-dark.a8697592.js";import"./focus-manager.05708ea9.js";import"./position-engine.87ce25ed.js";import"./portal.20c95002.js";import"./focusout.5149158e.js";import"./QCard.679619c2.js";import"./currency.2af12bed.js";import"./QSpace.05e62aaf.js";import"./QCardSection.474d709b.js";import"./QDialog.2d6aecbf.js";import"./ClosePopup.d130a45b.js";import"./ClickableCardItem.24ce8c9f.js";import"./QImg.18303433.js";import"./QItemLabel.ded98037.js";import"./QList.5cbf1bc0.js";import"./browser.1a1bd576.js";import"./on-form-validation-error.d7847268.js";import"./capitalize.b0e9fa3f.js";const P=S({__name:"CourierOrderStatusButton",props:{order:{}},emits:["statusUpdated"],setup(g,{emit:d}){const l=g,r=m(()=>l.order),e=d,p=$(),u=x(),o=N(!1),s=m(()=>r.value.deliveringDate?"positive":"primary"),v=m(()=>r.value.deliveringDate?p.value.finishDelivering:p.value.startDelivering);function _(){let h=null;o.value=!0,r.value.deliveringDate?h=u.commit.sync(B({orderId:r.value.id,isEmployee:!0})):h=u.commit.sync(V({orderId:r.value.id})),h.finally(()=>{o.value=!1,e("statusUpdated")})}return(h,Y)=>(t(),i(n(b),{color:s.value,loading:o.value,onClick:_},{default:a(()=>[k(y(v.value),1)]),_:1},8,["color","loading"]))}}),H={class:"full-height column"},W={class:"flex-grow column justify-between"},z={class:"text-dark text-h6 text-weight-bold"},J={class:"row gap-sm q-py-xs"},K=S({__name:"CourierOrderView",props:{order:{}},setup(g){const d=g,l=$();x();const r=N(!1),e=m(()=>d.order);function p(){var o;(o=window==null?void 0:window.open(`http://www.google.com/maps/place?q=${G(e.value.address)}`,"_blank"))==null||o.focus()}function u(){var o;window==null||window.open(`tel:${(o=e.value.client)==null?void 0:o.phone}`)}return(o,s)=>(t(),C("div",null,[(t(),i(T,{key:e.value.id,"has-content":"","card-padding":"","apply-shadow":"","full-content-height":"","order-type":e.value.type},{content:a(()=>{var v;return[f("div",H,[c(Q,{"order-number":e.value.orderNumber,class:"text-h6 q-mb-sm","is-link":""},null,8,["order-number"]),f("div",W,[f("div",null,[c(O,{"model-value":n(F)(e.value.address),readonly:"","stack-label":"",type:"text",class:"q-mb-md w-fit"},{after:a(()=>[c(b,{round:"",dense:"",icon:"location_on",color:"primary",onClick:p,title:n(l).showOnMap},{default:a(()=>[c(D,null,{default:a(()=>[k(y(n(l).showOnMap),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["model-value"]),e.value.employee?(t(),i(O,{key:0,"model-value":(v=e.value.client)==null?void 0:v.phone,readonly:"","stack-label":"",type:"text",class:"q-mb-md w-fit","label-slot":""},{label:a(()=>{var _;return[f("p",null,[f("span",z,y((_=e.value.client)==null?void 0:_.firstName),1)])]}),after:a(()=>[c(b,{round:"",dense:"",icon:"call",color:"secondary",onClick:u,title:n(l).callClient},{default:a(()=>[c(D,null,{default:a(()=>[k(y(n(l).callClient),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["model-value"])):w("",!0)]),f("div",J,[e.value.paidDate||!e.value.deliveringDate?(t(),i(P,{key:0,order:e.value},null,8,["order"])):w("",!0),!e.value.paidDate&&e.value.employee?(t(),i(b,{key:1,color:"primary",onClick:s[0]||(s[0]=_=>r.value=!0)},{default:a(()=>[k(y(n(l).pay),1)]),_:1})):w("",!0)])])])]}),_:1},8,["order-type"])),c(j,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=v=>r.value=v),"order-number":e.value.orderNumber,"order-id":e.value.id,"order-type":e.value.type,"total-cost":n(A)(e.value)},null,8,["modelValue","order-number","order-id","order-type","total-cost"])]))}}),X={key:1},$e=S({__name:"CourierOrdersPage",setup(g){const d=x(),l=m(()=>d.state.auth.user.userId),r=m(()=>d.state.orders.ordersForCourier.filter(u=>!u.employee||u.employee.id===l.value)),e=m(()=>[R.ORDERS_FOR_COURIERS]),p=M(e,{store:d});return(u,o)=>(t(),C("div",null,[n(p)?(t(),i(U,{key:0})):(t(),C("div",X,[r.value.length?(t(),i(I,{key:0,tag:"div",name:"fade",class:"card-grid-lg"},{default:a(()=>[(t(!0),C(q,null,E(r.value,s=>(t(),i(K,{key:s.id,order:s},null,8,["order"]))),128))]),_:1})):(t(),i(L,{key:1}))]))]))}});export{$e as default};
