import{d as $,a as x,u as E,h as i,r as p,H as U,A as V,a9 as F,i as _,g as r,e as h,j as v,k as u,w as d,aj as q,ai as L,ba as k,cf as j,o as c,ah as M,ak as W,t as z,cg as G,b7 as H,ch as Y,Q as J}from"./index.a56c0b25.js";import{Q as K}from"./QInput.886048bb.js";import{Q as X,a as y}from"./QTable.bf9a05f5.js";import{Q as Z}from"./QRadio.a3882bb5.js";import{a as ee}from"./get-order-total-cost.1b7d98d1.js";import{u as ae,B as te}from"./BigSpinner.09969e17.js";import{_ as se}from"./FilterPill.6e32a09b.js";import{_ as le}from"./NoData.9c6b1f73.js";import{f as oe}from"./currency.2af12bed.js";const re={key:1},ne={class:"q-mb-lg max-w-sm"},ie={class:"q-mb-lg gap-sm row"},_e=$({__name:"OrdersList",props:{getChannel:{type:Function}},setup(C){const N=C,l=x(),t=E(),O=i(()=>l.state.orders.ordersPage),g=i(()=>l.state.auth.user.userId),P=i(()=>g.value===H.userId?[]:[N.getChannel(g.value||"")]);let b=ae(P,{store:l});const w=p(()=>{}),A=i(()=>["active",...Y,"completed"]),n=p(null),f=p(!1),o=p("active"),B=i(()=>o.value+n.value),m=p({page:1,rowsPerPage:k,rowsNumber:k}),Q=i(()=>{var a;return(a=l.state.auth.user.permissions)==null?void 0:a.client}),R=[{name:"orderNumber",label:t.value.orderNumber,align:"left",field:"orderNumber"},{name:"type",label:t.value.orderType,align:"left",field:a=>t.value[`orderType_${a.type}`]},{name:"tableNumber",label:t.value.tableNumber,align:"left",field:a=>{var s;return((s=a.table)==null?void 0:s.number)||"-"}},{name:"dishCount",label:t.value.dishCount,align:"left",field:a=>a.dishes.length},{name:"total",label:t.value.total,align:"left",field:a=>oe(ee(a),!1)},{name:"status",label:t.value.orderStatus,align:"left"},{name:"paidDate",label:t.value.paid,align:"left",field:"paidDate"}],T=U(b,()=>{b.value||(m.value.rowsNumber=l.state.orders.totalOrders,T())});V(()=>{w.value=l.client.on("user",a=>{g.value=a})}),F(()=>{w.value()});const D=a=>{o.value=a},I=({pagination:{page:a}})=>{var s;f.value=!0,l.commit.sync(j({page:a,status:o.value==="active"||o.value==="completed"||n.value?void 0:o.value,search:((s=n.value)==null?void 0:s.trim())||void 0,isClient:Q.value,completed:o.value==="completed"})).then(()=>{m.value.page=a,m.value.rowsNumber=l.state.orders.totalOrders}).finally(()=>{f.value=!1})};return(a,s)=>(c(),_("div",null,[r(b)?(c(),h(te,{key:0})):(c(),_("div",re,[v("div",ne,[u(K,{class:"bg-white",outlined:"",modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=e=>n.value=e),debounce:"500",placeholder:r(t).searchOrders,clearable:""},{append:d(()=>{var e;return[(e=n.value)!=null&&e.length?M("",!0):(c(),h(J,{key:0,name:"search"}))]}),_:1},8,["modelValue","placeholder"])]),v("div",ie,[(c(!0),_(q,null,L(A.value,e=>(c(),h(se,{key:e,id:e,name:r(t)[`orderStatus_${e}`],"custom-color":e==="active"?void 0:e,"selected-id":o.value,onClick:S=>D(e)},null,8,["id","name","custom-color","selected-id","onClick"]))),128))]),v("div",null,[u(X,{class:"max-w-lg q-pa-sm",rows:O.value,columns:R,loading:f.value,"row-key":"id","rows-per-page-label":r(t).perPage,"rows-per-page-options":[],filter:B.value,pagination:m.value,"onUpdate:pagination":s[1]||(s[1]=e=>m.value=e),onRequest:I,onRowClick:s[2]||(s[2]=(e,S)=>r(l).commit.local(r(G)({order:S})))},{"body-cell-status":d(e=>[u(y,{props:e},{default:d(()=>[v("span",{class:W(`text-${e.row.status}`)},z(r(t)[`orderStatus_${e.row.status}`].toString().toLowerCase()),3)]),_:2},1032,["props"])]),"body-cell-paidDate":d(e=>[u(y,{props:e},{default:d(()=>[u(Z,{dense:"",class:"disabled-cursor-default","model-value":"true","checked-icon":"task_alt","unchecked-icon":"close",val:Boolean(e.row.paidDate).toString(),label:"",disable:"",color:Boolean(e.row.paidDate)?"positive":"negative","keep-color":""},null,8,["val","color"])]),_:2},1032,["props"])]),"no-data":d(()=>[u(le)]),_:1},8,["rows","loading","rows-per-page-label","filter","pagination"])])]))]))}});export{_e as _};
