import{d as $,a as x,u as E,h as n,r as p,H as U,A as V,a9 as F,o as i,i as _,g as u,e as h,j as v,k as d,w as c,ae as q,ad as L,aC as M,ca as W,a$ as C,cb as j,Q as z,ac as G,af as H,t as Y,cc as J}from"./index.92b1981f.js";import{Q as K}from"./QInput.7bd0947e.js";import{Q as X,a as S}from"./QTable.f17bfb21.js";import{Q as Z}from"./QRadio.a52b195c.js";import{g as ee}from"./get-order-total-cost.4c90e68f.js";import{u as ae,B as te}from"./BigSpinner.23930169.js";import{_ as le}from"./FilterPill.13e52a61.js";import{_ as se}from"./NoData.b4eb18ee.js";import{f as oe}from"./currency.2af12bed.js";const re={key:1},ne={class:"q-mb-lg max-w-sm"},ie={class:"q-mb-lg gap-sm row"},_e=$({__name:"OrdersList",props:{getChannel:{type:Function}},setup(k){const N=k,s=x(),l=E(),O=n(()=>s.state.orders.ordersPage),g=n(()=>s.state.auth.user.userId),P=n(()=>g.value===M.userId?[]:[N.getChannel(g.value||"")]);let b=ae(P,{store:s});const w=p(()=>{}),A=n(()=>["active",...W,"completed"]),r=p(null),f=p(!1),o=p("active"),B=n(()=>o.value+r.value),m=p({page:1,rowsPerPage:C,rowsNumber:C}),Q=n(()=>{var a;return(a=s.state.auth.user.permissions)==null?void 0:a.client}),R=[{name:"orderNumber",label:l.value.orderNumber,align:"left",field:"orderNumber"},{name:"type",label:l.value.orderType,align:"left",field:a=>l.value[`orderType_${a.type}`]},{name:"tableNumber",label:l.value.tableNumber,align:"left",field:a=>{var t;return((t=a.table)==null?void 0:t.number)||"-"}},{name:"dishCount",label:l.value.dishCount,align:"left",field:a=>a.dishes.length},{name:"total",label:l.value.total,align:"left",field:a=>oe(ee(a),!1)},{name:"status",label:l.value.orderStatus,align:"left"},{name:"paidDate",label:l.value.paid,align:"left",field:"paidDate"}],T=U(b,()=>{b.value||(m.value.rowsNumber=s.state.orders.totalOrders,T())});V(()=>{w.value=s.client.on("user",a=>{g.value=a})}),F(()=>{w.value()});const D=a=>{o.value=a},I=({pagination:{page:a}})=>{var t;f.value=!0,s.commit.sync(j({page:a,status:o.value==="active"||o.value==="completed"||r.value?void 0:o.value,search:((t=r.value)==null?void 0:t.trim())||void 0,isClient:Q.value,completed:o.value==="completed"})).then(()=>{m.value.page=a,m.value.rowsNumber=s.state.orders.totalOrders}).finally(()=>{f.value=!1})};return(a,t)=>(i(),_("div",null,[u(b)?(i(),h(te,{key:0})):(i(),_("div",re,[v("div",ne,[d(K,{class:"bg-white",outlined:"",modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),debounce:"500",placeholder:u(l).searchOrders,clearable:""},{append:c(()=>{var e;return[(e=r.value)!=null&&e.length?G("",!0):(i(),h(z,{key:0,name:"search"}))]}),_:1},8,["modelValue","placeholder"])]),v("div",ie,[(i(!0),_(q,null,L(A.value,e=>(i(),h(le,{key:e,id:e,name:u(l)[`orderStatus_${e}`],"custom-color":e==="active"?void 0:e,"selected-id":o.value,onClick:y=>D(e)},null,8,["id","name","custom-color","selected-id","onClick"]))),128))]),v("div",null,[d(X,{class:"max-w-lg q-pa-sm",rows:O.value,columns:R,loading:f.value,"row-key":"id","rows-per-page-label":u(l).perPage,"rows-per-page-options":[],filter:B.value,pagination:m.value,"onUpdate:pagination":t[1]||(t[1]=e=>m.value=e),onRequest:I,onRowClick:t[2]||(t[2]=(e,y)=>u(s).commit.local(u(J)({order:y})))},{"body-cell-status":c(e=>[d(S,{props:e},{default:c(()=>[v("span",{class:H(`text-${e.row.status}`)},Y(e.row.status),3)]),_:2},1032,["props"])]),"body-cell-paidDate":c(e=>[d(S,{props:e},{default:c(()=>[d(Z,{dense:"",class:"disabled-cursor-default","model-value":"true","checked-icon":"task_alt","unchecked-icon":"close",val:Boolean(e.row.paidDate).toString(),label:"",disable:"",color:Boolean(e.row.paidDate)?"positive":"negative","keep-color":""},null,8,["val","color"])]),_:2},1032,["props"])]),"no-data":c(()=>[d(se)]),_:1},8,["rows","loading","rows-per-page-label","filter","pagination"])])]))]))}});export{_e as _};
