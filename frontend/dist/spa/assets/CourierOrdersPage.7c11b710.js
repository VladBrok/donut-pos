import{d as S,h as m,u as $,a as x,r as N,e as n,w as a,g as i,bW as B,cn as V,o as t,f as k,t as y,n as b,i as w,k as c,j as f,ah as C,cc as I,aj as Q,ai as q}from"./index.4cce736f.js";import{u as E,C as M,B as R}from"./BigSpinner.06e3b354.js";import{Q as O}from"./QTooltip.9bedcaa0.js";import{Q as D}from"./QInput.d6c33dc7.js";import{a as U}from"./get-order-total-cost.5554df13.js";import{_ as A}from"./OrderNumberTitle.48c3fcf8.js";import{_ as T}from"./OrderView.41e3a9f2.js";import{_ as j}from"./PaymentMethodsModal.35077e3f.js";import{f as F,m as G}from"./address.b5e3391c.js";import{_ as L}from"./NoData.6380666a.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.7ee357ac.js";import"./focus-manager.05708ea9.js";import"./portal.956af910.js";import"./use-dark.e2ec4b55.js";import"./focusout.e7700cc2.js";import"./QCard.2050a505.js";import"./currency.2af12bed.js";import"./QSpace.96dd2209.js";import"./QCardSection.c5448da3.js";import"./QDialog.868e66c9.js";import"./ClosePopup.fb3bc6eb.js";import"./ClickableCardItem.22d470ae.js";import"./QImg.d6afc986.js";import"./QItemLabel.cd716551.js";import"./QList.1a5a7c5e.js";import"./browser.1a1bd576.js";import"./on-form-validation-error.6285baa3.js";import"./capitalize.b0e9fa3f.js";const P=S({__name:"CourierOrderStatusButton",props:{order:{}},emits:["statusUpdated"],setup(g,{emit:d}){const l=g,r=m(()=>l.order),e=d,p=$(),u=x(),o=N(!1),s=m(()=>r.value.deliveringDate?"positive":"primary"),v=m(()=>r.value.deliveringDate?p.value.finishDelivering:p.value.startDelivering);function _(){let h=null;o.value=!0,r.value.deliveringDate?h=u.commit.sync(B({orderId:r.value.id,isEmployee:!0})):h=u.commit.sync(V({orderId:r.value.id})),h.finally(()=>{o.value=!1,e("statusUpdated")})}return(h,Y)=>(t(),n(i(b),{color:s.value,loading:o.value,onClick:_},{default:a(()=>[k(y(v.value),1)]),_:1},8,["color","loading"]))}}),H={class:"full-height column"},W={class:"flex-grow column justify-between"},z={class:"text-dark text-h6 text-weight-bold"},J={class:"row gap-sm q-py-xs"},K=S({__name:"CourierOrderView",props:{order:{}},setup(g){const d=g,l=$();x();const r=N(!1),e=m(()=>d.order);function p(){var o;(o=window==null?void 0:window.open(`http://www.google.com/maps/place?q=${G(e.value.address)}`,"_blank"))==null||o.focus()}function u(){var o;window==null||window.open(`tel:${(o=e.value.client)==null?void 0:o.phone}`)}return(o,s)=>(t(),w("div",null,[(t(),n(T,{key:e.value.id,"has-content":"","card-padding":"","apply-shadow":"","full-content-height":"","order-type":e.value.type},{content:a(()=>{var v;return[f("div",H,[c(A,{"order-number":e.value.orderNumber,class:"text-h6 q-mb-sm","is-link":""},null,8,["order-number"]),f("div",W,[f("div",null,[c(D,{"model-value":i(F)(e.value.address),readonly:"","stack-label":"",type:"text",class:"q-mb-md w-fit"},{after:a(()=>[c(b,{round:"",dense:"",icon:"location_on",color:"primary",onClick:p,title:i(l).showOnMap},{default:a(()=>[c(O,null,{default:a(()=>[k(y(i(l).showOnMap),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["model-value"]),e.value.employee?(t(),n(D,{key:0,"model-value":(v=e.value.client)==null?void 0:v.phone,readonly:"","stack-label":"",type:"text",class:"q-mb-md w-fit","label-slot":""},{label:a(()=>{var _;return[f("p",null,[f("span",z,y((_=e.value.client)==null?void 0:_.firstName),1)])]}),after:a(()=>[c(b,{round:"",dense:"",icon:"call",color:"secondary",onClick:u,title:i(l).callClient},{default:a(()=>[c(O,null,{default:a(()=>[k(y(i(l).callClient),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["model-value"])):C("",!0)]),f("div",J,[e.value.paidDate||!e.value.deliveringDate?(t(),n(P,{key:0,order:e.value},null,8,["order"])):C("",!0),!e.value.paidDate&&e.value.employee?(t(),n(b,{key:1,color:"primary",onClick:s[0]||(s[0]=_=>r.value=!0)},{default:a(()=>[k(y(i(l).pay),1)]),_:1})):C("",!0)])])])]}),_:1},8,["order-type"])),c(j,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=v=>r.value=v),"order-number":e.value.orderNumber,"order-id":e.value.id,"order-type":e.value.type,"total-cost":i(U)(e.value)},null,8,["modelValue","order-number","order-id","order-type","total-cost"])]))}}),X={key:1},$e=S({__name:"CourierOrdersPage",setup(g){const d=x(),l=m(()=>d.state.auth.user.userId),r=m(()=>d.state.orders.ordersForCourier.filter(u=>!u.employee||u.employee.id===l.value)),e=m(()=>[M.ORDERS_FOR_COURIERS]),p=E(e,{store:d});return(u,o)=>(t(),w("div",null,[i(p)?(t(),n(R,{key:0})):(t(),w("div",X,[r.value.length?(t(),n(I,{key:0,tag:"div",name:"fade",class:"card-grid-lg"},{default:a(()=>[(t(!0),w(Q,null,q(r.value,s=>(t(),n(K,{key:s.id,order:s},null,8,["order"]))),128))]),_:1})):(t(),n(L,{key:1}))]))]))}});export{$e as default};
