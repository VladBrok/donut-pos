import{d as S,h as m,u as $,a as x,r as N,e as i,w as a,g as n,bV as V,cm as B,o as t,f as k,t as y,n as b,i as w,k as c,j as f,ag as C,cb as I,ai as Q,ah as q}from"./index.1c3783dc.js";import{u as E,C as M,B as R}from"./BigSpinner.fa6acb5e.js";import{Q as O}from"./QTooltip.a983157c.js";import{Q as D}from"./QInput.e35961c4.js";import{a as U}from"./get-order-total-cost.41c8ba2d.js";import{_ as A}from"./OrderNumberTitle.cc0b4d02.js";import{_ as T}from"./OrderView.2978eef8.js";import{_ as F}from"./PaymentMethodsModal.9b75b336.js";import{f as j,m as G}from"./address.94d37a80.js";import{_ as L}from"./NoData.c28f0571.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.748a335e.js";import"./focus-manager.05708ea9.js";import"./use-dark.af62a438.js";import"./focusout.1641dfbb.js";import"./QCard.5aa3fe54.js";import"./currency.2af12bed.js";import"./QSpace.472bcaca.js";import"./QCardSection.ef6e6dbe.js";import"./QDialog.69ef5705.js";import"./ClosePopup.76c7f815.js";import"./browser.1a1bd576.js";import"./QImg.7b74f12e.js";import"./QItemLabel.b64ba62a.js";import"./QList.ba5e3c57.js";import"./on-form-validation-error.73894483.js";import"./capitalize.b0e9fa3f.js";const P=S({__name:"CourierOrderStatusButton",props:{order:{}},emits:["statusUpdated"],setup(g,{emit:d}){const l=g,r=m(()=>l.order),e=d,p=$(),u=x(),o=N(!1),s=m(()=>r.value.deliveringDate?"positive":"primary"),v=m(()=>r.value.deliveringDate?p.value.finishDelivering:p.value.startDelivering);function _(){let h=null;o.value=!0,r.value.deliveringDate?h=u.commit.sync(V({orderId:r.value.id,isEmployee:!0})):h=u.commit.sync(B({orderId:r.value.id})),h.finally(()=>{o.value=!1,e("statusUpdated")})}return(h,Y)=>(t(),i(n(b),{color:s.value,loading:o.value,onClick:_},{default:a(()=>[k(y(v.value),1)]),_:1},8,["color","loading"]))}}),H={class:"full-height column"},z={class:"flex-grow column justify-between"},J={class:"text-dark text-h6 text-weight-bold"},K={class:"row gap-sm q-py-xs"},W=S({__name:"CourierOrderView",props:{order:{}},setup(g){const d=g,l=$();x();const r=N(!1),e=m(()=>d.order);function p(){var o;(o=window==null?void 0:window.open(`http://www.google.com/maps/place?q=${G(e.value.address)}`,"_blank"))==null||o.focus()}function u(){var o;window==null||window.open(`tel:${(o=e.value.client)==null?void 0:o.phone}`)}return(o,s)=>(t(),w("div",null,[(t(),i(T,{key:e.value.id,"has-content":"","card-padding":"","apply-shadow":"","full-content-height":"","order-type":e.value.type},{content:a(()=>{var v;return[f("div",H,[c(A,{"order-number":e.value.orderNumber,class:"text-h6 q-mb-sm","is-link":""},null,8,["order-number"]),f("div",z,[f("div",null,[c(D,{"model-value":n(j)(e.value.address),readonly:"","stack-label":"",type:"text",class:"q-mb-md w-fit"},{after:a(()=>[c(b,{round:"",dense:"",icon:"location_on",color:"primary",onClick:p,title:n(l).showOnMap},{default:a(()=>[c(O,null,{default:a(()=>[k(y(n(l).showOnMap),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["model-value"]),e.value.employee?(t(),i(D,{key:0,"model-value":(v=e.value.client)==null?void 0:v.phone,readonly:"","stack-label":"",type:"text",class:"q-mb-md w-fit","label-slot":""},{label:a(()=>{var _;return[f("p",null,[f("span",J,y((_=e.value.client)==null?void 0:_.firstName),1)])]}),after:a(()=>[c(b,{round:"",dense:"",icon:"call",color:"secondary",onClick:u,title:n(l).callClient},{default:a(()=>[c(O,null,{default:a(()=>[k(y(n(l).callClient),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["model-value"])):C("",!0)]),f("div",K,[e.value.paidDate||!e.value.deliveringDate?(t(),i(P,{key:0,order:e.value},null,8,["order"])):C("",!0),!e.value.paidDate&&e.value.employee?(t(),i(b,{key:1,color:"primary",onClick:s[0]||(s[0]=_=>r.value=!0)},{default:a(()=>[k(y(n(l).pay),1)]),_:1})):C("",!0)])])])]}),_:1},8,["order-type"])),c(F,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=v=>r.value=v),"order-number":e.value.orderNumber,"order-id":e.value.id,"order-type":e.value.type,"total-cost":n(U)(e.value)},null,8,["modelValue","order-number","order-id","order-type","total-cost"])]))}}),X={key:1},Oe=S({__name:"CourierOrdersPage",setup(g){const d=x(),l=m(()=>d.state.auth.user.userId),r=m(()=>d.state.orders.ordersForCourier.filter(u=>!u.employee||u.employee.id===l.value)),e=m(()=>[M.ORDERS_FOR_COURIERS]),p=E(e,{store:d});return(u,o)=>(t(),w("div",null,[n(p)?(t(),i(R,{key:0})):(t(),w("div",X,[r.value.length?(t(),i(I,{key:0,tag:"div",name:"fade",class:"card-grid-lg"},{default:a(()=>[(t(!0),w(Q,null,q(r.value,s=>(t(),i(W,{key:s.id,order:s},null,8,["order"]))),128))]),_:1})):(t(),i(L,{key:1}))]))]))}});export{Oe as default};
