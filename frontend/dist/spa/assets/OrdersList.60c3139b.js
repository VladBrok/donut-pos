import{d as $,a as x,u as E,g as i,r as u,H as U,A as V,a9 as F,i as _,f as r,c as h,j as v,k as d,w as c,aj as q,ai as L,ba as k,cf as j,o as m,ah as M,ak as W,t as z,cg as G,b7 as H,ch as Y,Q as J}from"./index.7ae99152.js";import{Q as K}from"./QInput.23cad58c.js";import{Q as X,a as y}from"./QTable.806a36c5.js";import{Q as Z}from"./QRadio.d90b6b7b.js";import{a as ee}from"./get-order-total-cost.529a2137.js";import{u as ae,B as te}from"./BigSpinner.eadc8dfc.js";import{_ as le}from"./FilterPill.3fe72b25.js";import{_ as se}from"./NoData.23fba9a4.js";import{f as oe}from"./currency.2af12bed.js";const re={key:1},ne={class:"q-mb-lg max-w-sm"},ie={class:"q-mb-lg gap-sm row"},_e=$({__name:"OrdersList",props:{getChannel:{type:Function}},setup(C){const N=C,s=x(),t=E(),O=i(()=>s.state.orders.ordersPage),g=u(s.state.auth.user.userId),P=i(()=>g.value===H.userId?[]:[N.getChannel(g.value||"")]);let b=ae(P,{store:s});const w=u(()=>{}),A=i(()=>["active",...Y,"completed"]),n=u(null),f=u(!1),o=u("active"),B=i(()=>o.value+n.value),p=u({page:1,rowsPerPage:k,rowsNumber:k}),Q=i(()=>{var a;return(a=s.state.auth.user.permissions)==null?void 0:a.client}),R=i(()=>[{name:"orderNumber",label:t.value.orderNumber,align:"left",field:"orderNumber"},{name:"type",label:t.value.orderType,align:"left",field:a=>t.value[`orderType_${a.type}`]},{name:"tableNumber",label:t.value.tableNumber,align:"left",field:a=>{var l;return((l=a.table)==null?void 0:l.number)||"-"}},{name:"dishCount",label:t.value.dishCount,align:"left",field:a=>a.dishes.length},{name:"total",label:t.value.total,align:"left",field:a=>oe(ee(a),!1)},{name:"status",label:t.value.orderStatus,align:"left"},{name:"paidDate",label:t.value.paid,align:"left",field:"paidDate"}]),T=U(b,()=>{b.value||(p.value.rowsNumber=s.state.orders.totalOrders,T())});V(()=>{w.value=s.client.on("user",a=>{g.value=a})}),F(()=>{w.value()});const D=a=>{o.value=a},I=({pagination:{page:a}})=>{var l;f.value=!0,s.commit.sync(j({page:a,status:o.value==="active"||o.value==="completed"||n.value?void 0:o.value,search:((l=n.value)==null?void 0:l.trim())||void 0,isClient:Q.value,completed:o.value==="completed"})).then(()=>{p.value.page=a,p.value.rowsNumber=s.state.orders.totalOrders}).finally(()=>{f.value=!1})};return(a,l)=>(m(),_("div",null,[r(b)?(m(),h(te,{key:0})):(m(),_("div",re,[v("div",ne,[d(K,{class:"bg-white",outlined:"",modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),debounce:"500",placeholder:r(t).searchOrders,clearable:""},{append:c(()=>{var e;return[(e=n.value)!=null&&e.length?M("",!0):(m(),h(J,{key:0,name:"search"}))]}),_:1},8,["modelValue","placeholder"])]),v("div",ie,[(m(!0),_(q,null,L(A.value,e=>(m(),h(le,{key:e,id:e,name:r(t)[`orderStatus_${e}`],"custom-color":e==="active"?void 0:e,"selected-id":o.value,onClick:S=>D(e)},null,8,["id","name","custom-color","selected-id","onClick"]))),128))]),v("div",null,[d(X,{class:"max-w-lg q-pa-sm",rows:O.value,columns:R.value,loading:f.value,"row-key":"id","rows-per-page-label":r(t).perPage,"rows-per-page-options":[],filter:B.value,pagination:p.value,"onUpdate:pagination":l[1]||(l[1]=e=>p.value=e),onRequest:I,onRowClick:l[2]||(l[2]=(e,S)=>r(s).commit.local(r(G)({order:S})))},{"body-cell-status":c(e=>[d(y,{props:e},{default:c(()=>[v("span",{class:W(`text-${e.row.status}`)},z(r(t)[`orderStatus_${e.row.status}`].toString().toLowerCase()),3)]),_:2},1032,["props"])]),"body-cell-paidDate":c(e=>[d(y,{props:e},{default:c(()=>[d(Z,{dense:"",class:"disabled-cursor-default","model-value":"true","checked-icon":"task_alt","unchecked-icon":"close",val:Boolean(e.row.paidDate).toString(),label:"",disable:"",color:Boolean(e.row.paidDate)?"positive":"negative","keep-color":""},null,8,["val","color"])]),_:2},1032,["props"])]),"no-data":c(()=>[d(se)]),_:1},8,["rows","columns","loading","rows-per-page-label","filter","pagination"])])]))]))}});export{_e as _};
