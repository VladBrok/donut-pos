import{d as x,a as E,u as U,h as n,r as p,H as V,A as $,a9 as F,i as _,g as i,e as h,j as v,k as u,w as d,ai as q,ah as L,b9 as S,ce as j,o as c,ag as G,aj as M,t as W,cf as z,aG as H,cg as Y,Q as J}from"./index.1c3783dc.js";import{Q as K}from"./QInput.e35961c4.js";import{Q as X,a as k}from"./QTable.94823e87.js";import{Q as Z}from"./QRadio.5f9c7644.js";import{a as ee}from"./get-order-total-cost.41c8ba2d.js";import{u as ae,B as te}from"./BigSpinner.fa6acb5e.js";import{_ as le}from"./FilterPill.aff66cab.js";import{_ as se}from"./NoData.c28f0571.js";import{f as oe}from"./currency.2af12bed.js";const re={key:1},ne={class:"q-mb-lg max-w-sm"},ie={class:"q-mb-lg gap-sm row"},_e=x({__name:"OrdersList",props:{getChannel:{type:Function}},setup(C){const N=C,s=E(),l=U(),O=n(()=>s.state.orders.ordersPage),g=n(()=>s.state.auth.user.userId),P=n(()=>g.value===H.userId?[]:[N.getChannel(g.value||"")]);let b=ae(P,{store:s});const w=p(()=>{}),A=n(()=>["active",...Y,"completed"]),r=p(null),f=p(!1),o=p("active"),B=n(()=>o.value+r.value),m=p({page:1,rowsPerPage:S,rowsNumber:S}),Q=n(()=>{var a;return(a=s.state.auth.user.permissions)==null?void 0:a.client}),R=[{name:"orderNumber",label:l.value.orderNumber,align:"left",field:"orderNumber"},{name:"type",label:l.value.orderType,align:"left",field:a=>l.value[`orderType_${a.type}`]},{name:"tableNumber",label:l.value.tableNumber,align:"left",field:a=>{var t;return((t=a.table)==null?void 0:t.number)||"-"}},{name:"dishCount",label:l.value.dishCount,align:"left",field:a=>a.dishes.length},{name:"total",label:l.value.total,align:"left",field:a=>oe(ee(a),!1)},{name:"status",label:l.value.orderStatus,align:"left"},{name:"paidDate",label:l.value.paid,align:"left",field:"paidDate"}],T=V(b,()=>{b.value||(m.value.rowsNumber=s.state.orders.totalOrders,T())});$(()=>{w.value=s.client.on("user",a=>{g.value=a})}),F(()=>{w.value()});const D=a=>{o.value=a},I=({pagination:{page:a}})=>{var t;f.value=!0,s.commit.sync(j({page:a,status:o.value==="active"||o.value==="completed"||r.value?void 0:o.value,search:((t=r.value)==null?void 0:t.trim())||void 0,isClient:Q.value,completed:o.value==="completed"})).then(()=>{m.value.page=a,m.value.rowsNumber=s.state.orders.totalOrders}).finally(()=>{f.value=!1})};return(a,t)=>(c(),_("div",null,[i(b)?(c(),h(te,{key:0})):(c(),_("div",re,[v("div",ne,[u(K,{class:"bg-white",outlined:"",modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),debounce:"500",placeholder:i(l).searchOrders,clearable:""},{append:d(()=>{var e;return[(e=r.value)!=null&&e.length?G("",!0):(c(),h(J,{key:0,name:"search"}))]}),_:1},8,["modelValue","placeholder"])]),v("div",ie,[(c(!0),_(q,null,L(A.value,e=>(c(),h(le,{key:e,id:e,name:i(l)[`orderStatus_${e}`],"custom-color":e==="active"?void 0:e,"selected-id":o.value,onClick:y=>D(e)},null,8,["id","name","custom-color","selected-id","onClick"]))),128))]),v("div",null,[u(X,{class:"max-w-lg q-pa-sm",rows:O.value,columns:R,loading:f.value,"row-key":"id","rows-per-page-label":i(l).perPage,"rows-per-page-options":[],filter:B.value,pagination:m.value,"onUpdate:pagination":t[1]||(t[1]=e=>m.value=e),onRequest:I,onRowClick:t[2]||(t[2]=(e,y)=>i(s).commit.local(i(z)({order:y})))},{"body-cell-status":d(e=>[u(k,{props:e},{default:d(()=>[v("span",{class:M(`text-${e.row.status}`)},W(e.row.status),3)]),_:2},1032,["props"])]),"body-cell-paidDate":d(e=>[u(k,{props:e},{default:d(()=>[u(Z,{dense:"",class:"disabled-cursor-default","model-value":"true","checked-icon":"task_alt","unchecked-icon":"close",val:Boolean(e.row.paidDate).toString(),label:"",disable:"",color:Boolean(e.row.paidDate)?"positive":"negative","keep-color":""},null,8,["val","color"])]),_:2},1032,["props"])]),"no-data":d(()=>[u(se)]),_:1},8,["rows","loading","rows-per-page-label","filter","pagination"])])]))]))}});export{_e as _};
