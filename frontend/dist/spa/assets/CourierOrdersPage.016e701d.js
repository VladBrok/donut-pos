import{d as S,g as m,u as N,a as O,r as $,c as i,w as a,f as n,bW as B,cn as I,o as t,e as k,t as y,n as b,i as C,k as c,j as f,ah as w,cc as V,aj as M,ai as U,b7 as q}from"./index.7ae99152.js";import{u as A,C as E,B as R}from"./BigSpinner.eadc8dfc.js";import{Q as x}from"./QInput.23cad58c.js";import{a as Q}from"./get-order-total-cost.529a2137.js";import{C as D}from"./CommonTooltip.5bcc29f5.js";import{_ as T}from"./OrderNumberTitle.18255cb8.js";import{_ as j}from"./OrderView.9efe44ca.js";import{_ as F}from"./PaymentMethodsModal.544eeb4e.js";import{f as G,m as L}from"./address.b5e3391c.js";import{_ as P}from"./NoData.23fba9a4.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./use-dark.4188ae36.js";import"./focus-manager.05708ea9.js";import"./position-engine.4a6e0398.js";import"./portal.0d408b48.js";import"./focusout.54881aad.js";import"./QCard.ece06ff7.js";import"./currency.2af12bed.js";import"./QSpace.15764889.js";import"./QCardSection.e04a19bd.js";import"./QDialog.8b440e78.js";import"./ClosePopup.7d4f9e25.js";import"./ClickableCardItem.462f8540.js";import"./QImg.26e48284.js";import"./QItemLabel.4ac02820.js";import"./QList.7aa0273e.js";import"./browser.1a1bd576.js";import"./on-form-validation-error.f744f424.js";import"./capitalize.b0e9fa3f.js";const H=S({__name:"CourierOrderStatusButton",props:{order:{}},emits:["statusUpdated"],setup(g,{emit:d}){const l=g,r=m(()=>l.order),e=d,p=N(),u=O(),o=$(!1),s=m(()=>r.value.deliveringDate?"positive":"primary"),v=m(()=>r.value.deliveringDate?p.value.finishDelivering:p.value.startDelivering);function _(){let h=null;o.value=!0,r.value.deliveringDate?h=u.commit.sync(B({orderId:r.value.id,isEmployee:!0})):h=u.commit.sync(I({orderId:r.value.id})),h.finally(()=>{o.value=!1,e("statusUpdated")})}return(h,Z)=>(t(),i(n(b),{color:s.value,loading:o.value,onClick:_},{default:a(()=>[k(y(v.value),1)]),_:1},8,["color","loading"]))}}),W={class:"full-height column"},Y={class:"flex-grow column justify-between"},z={class:"text-dark text-h6 text-weight-bold"},J={class:"row gap-sm q-py-xs"},K=S({__name:"CourierOrderView",props:{order:{}},setup(g){const d=g,l=N();O();const r=$(!1),e=m(()=>d.order);function p(){var o;(o=window==null?void 0:window.open(`http://www.google.com/maps/place?q=${L(e.value.address)}`,"_blank"))==null||o.focus()}function u(){var o;window==null||window.open(`tel:${(o=e.value.client)==null?void 0:o.phone}`)}return(o,s)=>(t(),C("div",null,[(t(),i(j,{key:e.value.id,"has-content":"","card-padding":"","apply-shadow":"","full-content-height":"","order-type":e.value.type},{content:a(()=>{var v;return[f("div",W,[c(T,{"order-number":e.value.orderNumber,class:"text-h6 q-mb-sm","is-link":""},null,8,["order-number"]),f("div",Y,[f("div",null,[c(x,{"model-value":n(G)(e.value.address),readonly:"","stack-label":"",type:"text",class:"q-mb-md w-fit"},{after:a(()=>[c(b,{round:"",dense:"",icon:"location_on",color:"primary",onClick:p,title:n(l).showOnMap},{default:a(()=>[c(D,null,{default:a(()=>[k(y(n(l).showOnMap),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["model-value"]),e.value.employee?(t(),i(x,{key:0,"model-value":(v=e.value.client)==null?void 0:v.phone,readonly:"","stack-label":"",type:"text",class:"q-mb-md w-fit","label-slot":""},{label:a(()=>{var _;return[f("p",null,[f("span",z,y((_=e.value.client)==null?void 0:_.firstName),1)])]}),after:a(()=>[c(b,{round:"",dense:"",icon:"call",color:"secondary",onClick:u,title:n(l).callClient},{default:a(()=>[c(D,null,{default:a(()=>[k(y(n(l).callClient),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["model-value"])):w("",!0)]),f("div",J,[e.value.paidDate||!e.value.deliveringDate?(t(),i(H,{key:0,order:e.value},null,8,["order"])):w("",!0),!e.value.paidDate&&e.value.employee?(t(),i(b,{key:1,color:"primary",onClick:s[0]||(s[0]=_=>r.value=!0)},{default:a(()=>[k(y(n(l).pay),1)]),_:1})):w("",!0)])])])]}),_:1},8,["order-type"])),c(F,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=v=>r.value=v),"order-number":e.value.orderNumber,"order-id":e.value.id,"order-type":e.value.type,"total-cost":n(Q)(e.value)},null,8,["modelValue","order-number","order-id","order-type","total-cost"])]))}}),X={key:1},$e=S({__name:"CourierOrdersPage",setup(g){const d=O(),l=m(()=>d.state.auth.user.userId),r=m(()=>d.state.orders.ordersForCourier.filter(u=>!u.employee||u.employee.id===l.value)),e=m(()=>l.value===q.userId?[]:[E.ORDERS_FOR_COURIERS]),p=A(e,{store:d});return(u,o)=>(t(),C("div",null,[n(p)?(t(),i(R,{key:0})):(t(),C("div",X,[r.value.length?(t(),i(V,{key:0,tag:"div",name:"fade",class:"card-grid-lg"},{default:a(()=>[(t(!0),C(M,null,U(r.value,s=>(t(),i(K,{key:s.id,order:s},null,8,["order"]))),128))]),_:1})):(t(),i(P,{key:1}))]))]))}});export{$e as default};
